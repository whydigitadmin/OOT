PROC_EXPORT_BL_RELEASE_DESK_AIR

  CREATE OR REPLACE FORCE EDITIONABLE VIEW "DEVPHP"."PROC_EXPORT_BL_RELEASE_DESK_AIR" ("ID", "DEPT", "PRODUCT", "ACTION", "COUNT", "WITHINSLA", "OUTOFSLA") AS 
  SELECT sno id,
            dept,
            product,
            action,
            (withinsla + outofsla) COUNT,
            withinsla,
            outofsla
       FROM (  SELECT sno,
                      dept,
                      product,
                      action,
                      COUNT (withinsla) withinsla,
                      0 outofsla
                 FROM (  SELECT 1 sno,
                                'B/L Release Desk' Dept,
                                'Air Export' Product,
                                'Pending B/L Release' Action,
                                JMST_MASTER_BILL_NO,
                                JMST_MASTER_BILL_ISSUED_DATE,
                                JMST_CONSOL_MODE,
                                JMST_TRANSPORT_MODE,
                                CASE
                                   WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                        - TO_DATE (SYSDATE) <= 3
                                   THEN
                                      COUNT (*)
                                   ELSE
                                      0
                                END
                                   WithinSLA,
                                CASE
                                   WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                        - TO_DATE (SYSDATE) > 3
                                   THEN
                                      COUNT (*)
                                   ELSE
                                      0
                                END
                                   OutofSLA
                           FROM JMST_MASTER a
                          WHERE     UPPER (jmst_transport_mode) = 'AIR'
                                AND JMST_MASTER_BILL_NO IS NOT NULL
                       GROUP BY JMST_MASTER_BILL_NO,
                                JMST_MASTER_BILL_ISSUED_DATE,
                                JMST_CONSOL_MODE,
                                JMST_TRANSPORT_MODE,
                                  TO_DATE (JMST_A_DEPARTURE_DATE)
                                - TO_DATE (SYSDATE))
                WHERE withinsla > 0
             GROUP BY sno,
                      dept,
                      product,
                      action
             UNION
               SELECT sno,
                      dept,
                      product,
                      action,
                      0 withinsla,
                      COUNT (outofsla) outofsla
                 FROM (  SELECT 1 sno,
                                'B/L Release Desk' Dept,
                                'Air Export' Product,
                                'Pending B/L Release' Action,
                                JMST_MASTER_BILL_NO,
                                JMST_MASTER_BILL_ISSUED_DATE,
                                JMST_CONSOL_MODE,
                                JMST_TRANSPORT_MODE,
                                CASE
                                   WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                        - TO_DATE (SYSDATE) <= 3
                                   THEN
                                      COUNT (*)
                                   ELSE
                                      0
                                END
                                   WithinSLA,
                                CASE
                                   WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                        - TO_DATE (SYSDATE) > 3
                                   THEN
                                      COUNT (*)
                                   ELSE
                                      0
                                END
                                   OutofSLA
                           FROM JMST_MASTER a
                          WHERE     UPPER (jmst_transport_mode) = 'AIR'
                                AND JMST_MASTER_BILL_NO IS NOT NULL
                       GROUP BY JMST_MASTER_BILL_NO,
                                JMST_MASTER_BILL_ISSUED_DATE,
                                JMST_CONSOL_MODE,
                                JMST_TRANSPORT_MODE,
                                  TO_DATE (JMST_A_DEPARTURE_DATE)
                                - TO_DATE (SYSDATE))
                WHERE outofsla > 0
             GROUP BY sno,
                      dept,
                      product,
                      action)
   GROUP BY sno,
            dept,
            product,
            action,
            withinsla,
            outofsla;





2. PROC_EXPORT_BL_RELEASE_DESK_DETAILS_AIR

SELECT ROWNUM id,
          sno,
          dept,
          product,
          action,
         JMST_MASTER_BILL_NO REF_NO,
          JMST_MASTER_BILL_ISSUED_DATE REF_DATE,
          JMST_CONSOL_MODE REF_TYPE,
          JMST_TRANSPORT_MODE REF_MODE,
          withinsla,
          outofsla
     FROM (SELECT sno,
                  dept,
                  product,
                  action,
                  JMST_MASTER_BILL_NO,
                  JMST_MASTER_BILL_ISSUED_DATE,
                  JMST_CONSOL_MODE,
                  JMST_TRANSPORT_MODE,
                  withinsla,
                  outofsla
             FROM (  SELECT 1 sno,
                            'B/L Release Desk' Dept,
                            'Air Export' Product,
                            'Pending B/L Release' Action,
                            JMST_MASTER_BILL_NO,
                            JMST_MASTER_BILL_ISSUED_DATE,
                            JMST_CONSOL_MODE,
                            JMST_TRANSPORT_MODE,
                            CASE
                               WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                    - TO_DATE (SYSDATE) <= 3
                               THEN
                                  COUNT (*)
                               ELSE
                                  0
                            END
                               WithinSLA,
                            CASE
                               WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                    - TO_DATE (SYSDATE) > 3
                               THEN
                                  COUNT (*)
                               ELSE
                                  0
                            END
                               OutofSLA
                       FROM JMST_MASTER a
                      WHERE     UPPER (jmst_transport_mode) = 'AIR'
                            AND JMST_MASTER_BILL_NO IS NOT NULL
                   GROUP BY JMST_MASTER_BILL_NO,
                            JMST_MASTER_BILL_ISSUED_DATE,
                            JMST_CONSOL_MODE,
                            JMST_TRANSPORT_MODE,
                              TO_DATE (JMST_A_DEPARTURE_DATE)
                            - TO_DATE (SYSDATE))
            WHERE withinsla > 0
           UNION
           SELECT sno,
                  dept,
                  product,
                  action,
                  JMST_MASTER_BILL_NO,
                  JMST_MASTER_BILL_ISSUED_DATE,
                  JMST_CONSOL_MODE,
                  JMST_TRANSPORT_MODE,
                  withinsla,
                  outofsla
             FROM (  SELECT 1 sno,
                            'B/L Release Desk' Dept,
                            'Air Export' Product,
                            'Pending B/L Release' Action,
                            JMST_MASTER_BILL_NO,
                            JMST_MASTER_BILL_ISSUED_DATE,
                            JMST_CONSOL_MODE,
                            JMST_TRANSPORT_MODE,
                            CASE
                               WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                    - TO_DATE (SYSDATE) <= 3
                               THEN
                                  COUNT (*)
                               ELSE
                                  0
                            END
                               WithinSLA,
                            CASE
                               WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                    - TO_DATE (SYSDATE) > 3
                               THEN
                                  COUNT (*)
                               ELSE
                                  0
                            END
                               OutofSLA
                       FROM JMST_MASTER a
                      WHERE     UPPER (jmst_transport_mode) = 'AIR'
                            AND JMST_MASTER_BILL_NO IS NOT NULL
                   GROUP BY JMST_MASTER_BILL_NO,
                            JMST_MASTER_BILL_ISSUED_DATE,
                            JMST_CONSOL_MODE,
                            JMST_TRANSPORT_MODE,
                              TO_DATE (JMST_A_DEPARTURE_DATE)
                            - TO_DATE (SYSDATE))
            WHERE outofsla > 0)



3. PROC_EXPORT_BL_RELEASE_DESK_DETAILS_SEA

SELECT ROWNUM id,
          sno,
          dept,
          product,
          action,
          JMST_MASTER_BILL_NO REF_NO,
          JMST_MASTER_BILL_ISSUED_DATE REF_DATE,
          JMST_CONSOL_MODE REF_TYPE,
          JMST_TRANSPORT_MODE REF_MODE,
          withinsla,
          outofsla
     FROM (SELECT sno,
                  dept,
                  product,
                  action,
                  JMST_MASTER_BILL_NO,
                  JMST_MASTER_BILL_ISSUED_DATE,
                  JMST_CONSOL_MODE,
                  JMST_TRANSPORT_MODE,
                  withinsla,
                  outofsla
             FROM (  SELECT 1 sno,
                            'B/L Release Desk' Dept,
                            'Sea Export' Product,
                            'Pending B/L Release' Action,
                            JMST_MASTER_BILL_NO,
                            JMST_MASTER_BILL_ISSUED_DATE,
                            JMST_CONSOL_MODE,
                            JMST_TRANSPORT_MODE,
                            CASE
                               WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                    - TO_DATE (SYSDATE) <= 3
                               THEN
                                  COUNT (*)
                               ELSE
                                  0
                            END
                               WithinSLA,
                            CASE
                               WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                    - TO_DATE (SYSDATE) > 3
                               THEN
                                  COUNT (*)
                               ELSE
                                  0
                            END
                               OutofSLA
                       FROM JMST_MASTER a
                      WHERE     UPPER (jmst_transport_mode) = 'SEA'
                            AND JMST_MASTER_BILL_NO IS NOT NULL
                   GROUP BY JMST_MASTER_BILL_NO,
                            JMST_MASTER_BILL_ISSUED_DATE,
                            JMST_CONSOL_MODE,
                            JMST_TRANSPORT_MODE,
                              TO_DATE (JMST_A_DEPARTURE_DATE)
                            - TO_DATE (SYSDATE))
            WHERE withinsla > 0
           UNION
           SELECT sno,
                  dept,
                  product,
                  action,
                  JMST_MASTER_BILL_NO,
                  JMST_MASTER_BILL_ISSUED_DATE,
                  JMST_CONSOL_MODE,
                  JMST_TRANSPORT_MODE,
                  withinsla,
                  outofsla
             FROM (  SELECT 1 sno,
                            'B/L Release Desk' Dept,
                            'Sea Export' Product,
                            'Pending B/L Release' Action,
                            JMST_MASTER_BILL_NO,
                            JMST_MASTER_BILL_ISSUED_DATE,
                            JMST_CONSOL_MODE,
                            JMST_TRANSPORT_MODE,
                            CASE
                               WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                    - TO_DATE (SYSDATE) <= 3
                               THEN
                                  COUNT (*)
                               ELSE
                                  0
                            END
                               WithinSLA,
                            CASE
                               WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                    - TO_DATE (SYSDATE) > 3
                               THEN
                                  COUNT (*)
                               ELSE
                                  0
                            END
                               OutofSLA
                       FROM JMST_MASTER a
                      WHERE     UPPER (jmst_transport_mode) = 'SEA'
                            AND JMST_MASTER_BILL_NO IS NOT NULL
                   GROUP BY JMST_MASTER_BILL_NO,
                            JMST_MASTER_BILL_ISSUED_DATE,
                            JMST_CONSOL_MODE,
                            JMST_TRANSPORT_MODE,
                              TO_DATE (JMST_A_DEPARTURE_DATE)
                            - TO_DATE (SYSDATE))
            WHERE outofsla > 0)

4. PROC_EXPORT_BL_RELEASE_DESK_SEA

SELECT sno id,
            dept,
            product,
            action,
            (withinsla + outofsla) COUNT,
            withinsla,
            outofsla
       FROM (  SELECT sno,
                      dept,
                      product,
                      action,
                      COUNT (withinsla) withinsla,
                      0 outofsla
                 FROM (  SELECT 1 sno,
                                'B/L Release Desk' Dept,
                                'Sea Export' Product,
                                'Pending B/L Release' Action,
                                JMST_MASTER_BILL_NO,
                                JMST_MASTER_BILL_ISSUED_DATE,
                                JMST_CONSOL_MODE,
                                JMST_TRANSPORT_MODE,
                                CASE
                                   WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                        - TO_DATE (SYSDATE) <= 3
                                   THEN
                                      COUNT (*)
                                   ELSE
                                      0
                                END
                                   WithinSLA,
                                CASE
                                   WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                        - TO_DATE (SYSDATE) > 3
                                   THEN
                                      COUNT (*)
                                   ELSE
                                      0
                                END
                                   OutofSLA
                           FROM JMST_MASTER a
                          WHERE     UPPER (jmst_transport_mode) = 'SEA'
                                AND JMST_MASTER_BILL_NO IS NOT NULL
                       GROUP BY JMST_MASTER_BILL_NO,
                                JMST_MASTER_BILL_ISSUED_DATE,
                                JMST_CONSOL_MODE,
                                JMST_TRANSPORT_MODE,
                                  TO_DATE (JMST_A_DEPARTURE_DATE)
                                - TO_DATE (SYSDATE))
                WHERE withinsla > 0
             GROUP BY sno,
                      dept,
                      product,
                      action
             UNION
               SELECT sno,
                      dept,
                      product,
                      action,
                      0 withinsla,
                      COUNT (outofsla) outofsla
                 FROM (  SELECT 1 sno,
                                'B/L Release Desk' Dept,
                                'Sea Export' Product,
                                'Pending B/L Release' Action,
                                JMST_MASTER_BILL_NO,
                                JMST_MASTER_BILL_ISSUED_DATE,
                                JMST_CONSOL_MODE,
                                JMST_TRANSPORT_MODE,
                                CASE
                                   WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                        - TO_DATE (SYSDATE) <= 3
                                   THEN
                                      COUNT (*)
                                   ELSE
                                      0
                                END
                                   WithinSLA,
                                CASE
                                   WHEN   TO_DATE (JMST_A_DEPARTURE_DATE)
                                        - TO_DATE (SYSDATE) > 3
                                   THEN
                                      COUNT (*)
                                   ELSE
                                      0
                                END
                                   OutofSLA
                           FROM JMST_MASTER a
                          WHERE     UPPER (jmst_transport_mode) = 'SEA'
                                AND JMST_MASTER_BILL_NO IS NOT NULL
                       GROUP BY JMST_MASTER_BILL_NO,
                                JMST_MASTER_BILL_ISSUED_DATE,
                                JMST_CONSOL_MODE,
                                JMST_TRANSPORT_MODE,
                                  TO_DATE (JMST_A_DEPARTURE_DATE)
                                - TO_DATE (SYSDATE))
                WHERE outofsla > 0
             GROUP BY sno,
                      dept,
                      product,
                      action)
   GROUP BY sno,
            dept,
            product,
            action,
            withinsla,
            outofsla

5. PROC_EXPORT_CUSTOMER_SERVICE_AIR

SELECT id,
          dept,
          product,
          action,
          CASE WHEN COUNT IS NULL THEN 0 ELSE COUNT END COUNT,
          CASE WHEN withinsla IS NULL THEN 0 ELSE withinsla END withinsla,
          CASE WHEN outofsla IS NULL THEN 0 ELSE outofsla END outofsla
     FROM (  
     SELECT sno id,
                    dept,
                    product,
                    action,
                    SUM (withinsla + outofsla) COUNT,
                    CASE WHEN sno IN (1, 3) THEN 0 ELSE SUM (withinsla) END
                       withinsla,
                    CASE WHEN sno IN (1, 3) THEN 0 ELSE SUM (outofsla) END
                       outofsla
               FROM (
               SELECT 1 sno,
                            'Export Customer Service' Dept,
                            'Air Export' Product,
                            'Approved Quotation ( Agent / Shipper)' Action,
                            COUNT (*) WithinSLA,
                            0 OutofSLA
                       FROM RTEY_RATE_ENTRY
                      WHERE RTEY_STATUS = 'Approved'
                     UNION
                       SELECT sno,
                              dept,
                              product,
                              action,
                              SUM (withinsla) withinsla,
                              SUM (outofsla) outofsla
                         FROM (  SELECT 2 sno,
                                        'Export Customer Service' Dept,
                                        'Air Export' Product,
                                        'New Nomination Routing Order / New Booking from SHPR' Action,
                                        CASE
                                           WHEN   EXTRACT (
                                                     HOUR FROM CAST (
                                                                  a.updated_date AS TIMESTAMP))
                                                - EXTRACT (
                                                     HOUR FROM CAST (
                                                                  jshp_a_booking_date AS TIMESTAMP)) <=
                                                   4
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           WithinSLA,
                                        CASE
                                           WHEN   EXTRACT (
                                                     HOUR FROM CAST (
                                                                  a.updated_date AS TIMESTAMP))
                                                - EXTRACT (
                                                     HOUR FROM CAST (
                                                                  jshp_a_booking_date AS TIMESTAMP)) >
                                                   4
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           OutofSLA
                                   FROM JSHP_SHIPMENT a, JMIL_MILESTONE b
                                  WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                                        AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                                        AND b.JMIL_NAME =
                                               'CONTACTED SHIPPER FOR CARGO READINESS'
                                        AND a.JSHP_FREIGHT_MODE = 'Collect'
                               GROUP BY   EXTRACT (
                                             HOUR FROM CAST (
                                                          a.updated_date AS TIMESTAMP))
                                        - EXTRACT (
                                             HOUR FROM CAST (
                                                          jshp_a_booking_date AS TIMESTAMP)))
                     GROUP BY sno,
                              dept,
                              product,
                              action
                     UNION
                       SELECT 3 sno,
                              'Export Customer Service' Dept,
                              'Air Export' Product,
                              'Pending Carrier Booking' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE)
                     UNION
                       SELECT 4 sno,
                              'Export Customer Service' Dept,
                              'Air Export' Product,
                              'Pending Flight details update' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE)
                     UNION
                       SELECT 5 sno,
                              'Export Customer Service' Dept,
                              'Air Export' Product,
                              'Master Job Creation/Listing' Action,
                              0 withinsla,
                              0 outofsla
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE)
                     UNION
                       SELECT 6 sno,
                              'Export Customer Service' Dept,
                              'Air Export' Product,
                              'Shipment Under Process' Action,
                              0 withinsla,
                              0 outofsla
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_CARGO_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE)
                     UNION
                       SELECT 7 sno,
                              'Export Customer Service' Dept,
                              'Air Export' Product,
                              'Pending Cargo Pickup' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_E_DEPARTURE_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE)
                     UNION
                       SELECT 8 sno,
                              'Export Customer Service' Dept,
                              'Air Export' Product,
                              'Pending Cargo receipt' Acltion,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_CARGO_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE)
                     UNION
                       SELECT 9 sno,
                              'Export Customer Service' Dept,
                              'Air Export' Product,
                              'Pending DG application(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE)
                     UNION
                       SELECT sno,
                              dept,
                              product,
                              action,
                              SUM (withinsla) withinsla,
                              SUM (outofsla) outofsla
                         FROM (  SELECT 10 sno,
                                        'Export Customer Service' Dept,
                                        'Air Export' Product,
                                        'Pending DG approval(If applicable)' Action,
                                        CASE
                                           WHEN   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                                - TO_DATE (JCUS_DG_APPROVED_DATE) <=
                                                   1
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           WithinSLA,
                                        CASE
                                           WHEN   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                                - TO_DATE (JCUS_DG_APPROVED_DATE) >
                                                   1
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           OutofSLA
                                   FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                                  WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                                        AND a.JSHP_RID = b.JCUS_JSHP
                                        AND JCUS_DG_BOOKING_DATE IS NOT NULL
                               GROUP BY   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                        - TO_DATE (JCUS_DG_APPROVED_DATE)
                                        union
                                        SELECT 11 sno,
                              'Export Customer Service' Dept,
                              'Air Export' Product,
                              'Pending Export Customs Filing' Acltion,
                              0 withinsla,
                              0 outofsla from dual
                              union
                              SELECT 12 sno,
                              'Export Customer Service' Dept,
                              'Air Export' Product,
                              'Pending MS updates-TAB' Action,
                              0 withinsla,
                              0 outofsla from dual ) group by sno,dept,action,product
                              )                  
                              GROUP BY sno,
                    dept,
                    product,action
                           ORDER BY sno ASC)

6. PROC_EXPORT_CUSTOMER_SERVICE_FCL

SELECT sno,
          dept,
          product,
          action,
          CASE WHEN COUNT IS NULL THEN 0 ELSE COUNT END COUNT,
          CASE WHEN withinsla IS NULL THEN 0 ELSE withinsla END withinsla,
          CASE WHEN outofsla IS NULL THEN 0 ELSE outofsla END outofsla
     FROM (  SELECT sno,
                    dept,
                    product,
                    action,
                    SUM (withinsla + outofsla) COUNT,
                    CASE WHEN sno IN (1) THEN 0 ELSE SUM (withinsla) END
                       withinsla,
                    CASE WHEN sno IN (1) THEN 0 ELSE SUM (outofsla) END
                       outofsla
               FROM (SELECT 1 sno,
                            'Export Customer Service (FCL)' Dept,
                            'Sea Export' Product,
                            'Approved Quotations' Action,
                            COUNT (*) WithinSLA,
                            0 OutofSLA
                       FROM RTEY_RATE_ENTRY
                      WHERE RTEY_STATUS = 'Approved'
                     UNION
                       SELECT 2 sno,
                              'Export Customer Service (FCL)' Dept,
                              'Sea Export' Product,
                              'New Nomination Routing Order' Action,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) <=
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) >
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT a,
                              JMIL_MILESTONE b,
                              MDPT_DEPARTMENT c
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                              AND b.JMIL_NAME =
                                     'CONTACTED SHIPPER FOR CARGO READINESS'
                              AND a.JSHP_FREIGHT_MODE = 'Collect'
                              AND c.MDPT_RID = JSHP_MDPT
                              AND MDPT_SEA = 'Y'
                              AND c.MDPT_EXPORT = 'Y'
                              AND c.MDPT_FCL = 'Y'
                     GROUP BY   EXTRACT (
                                   HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                              - EXTRACT (
                                   HOUR FROM CAST (
                                                jshp_a_booking_date AS TIMESTAMP))
                     UNION
                     SELECT 3 sno,
                            'Export Customer Service (FCL)' Dept,
                            'Sea Export' Product,
                            'SHIPMENT UNDER PROCESS' Action,
                            COUNT (*) WithinSLA,
                            0 OutofSLA
                       FROM JSHP_SHIPMENT a,
                            JMIL_MILESTONE b,
                            MDPT_DEPARTMENT c
                      WHERE     UPPER (jshp_transport_mode) = 'SEA'
                            AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                            AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                            AND a.JSHP_SHIPPED_ON_BOARD_DATE IS NULL
                            AND b.JMIL_NAME =
                                   'SHIPPER CONTACTED FOR CARGO READINESS'
                            AND a.JSHP_SHIPMENT_STATUS = 'Active'
                            AND c.MDPT_RID = JSHP_MDPT
                            AND MDPT_SEA = 'Y'
                            AND c.MDPT_EXPORT = 'Y'
                            AND c.MDPT_FCL = 'Y'
                     UNION
                       SELECT 4 sno,
                              'Export Customer Service (FCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG application(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) <= 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) > 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE)
                     UNION
                       SELECT 5 sno,
                              'Export Customer Service (FCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG approval(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b, MDPT_DEPARTMENT c
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NOT NULL
                              AND c.MDPT_RID = JSHP_MDPT
                              AND MDPT_SEA = 'Y'
                              AND c.MDPT_EXPORT = 'Y'
                              AND c.MDPT_FCL = 'Y'
                     GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_APPROVED_DATE)
                     UNION
                     SELECT 6 sno,
                            'Export Customer Service (FCL)' Dept,
                            'Sea Export' Product,
                            'Pending Export Customs Filing' Action,
                            count(jshp_rid) withinsla,
                            0 outofsla
                       FROM jshp_shipment where  JSHP_CLEARANCE_REQUIRED_DATE is null
                       AND  UPPER (jshp_transport_mode) = 'SEA'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT' 
                     UNION
                     SELECT 7 sno,
                            'Export Customer Service (FCL)' Dept,
                            'Sea Export' Product,
                            'Pending MS updates-TAB' Action,
                            0 withinsla,
                            0 outofsla
                       FROM DUAL
                     UNION
                     SELECT 8 sno,
                            'Export Customer Service (FCL)' Dept,
                            'Sea Export' Product,
                            'Pending Empty Container placement' Action,
                            count(jshp_rid) withinsla,
                            0 outofsla
                       FROM jshp_shipment where  JSHP_TRANSPORT_REQUIRED_DATE is null
                       AND  UPPER (jshp_transport_mode) = 'SEA'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT' 
                     UNION
                      SELECT 9 sno,
                            'Export Customer Service (FCL)' Dept,
                            'Sea Export' Product,
                            'Pending Stuffed Container Gate-in' Action,
                            count(jshp_rid) withinsla,
                            0 outofsla
                       FROM jshp_shipment where  JSHP_TRANSPORT_COMPLETED_ON is null
                       AND  UPPER (jshp_transport_mode) = 'SEA'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'                   )
           GROUP BY sno,
                    dept,
                    product,
                    action
           ORDER BY sno,
                    dept,
                    product,
                    action)

7. PROC_EXPORT_CUSTOMER_SERVICE_FCL_1

SELECT ROWNUM AS ID,
          j."DEPT",
          j."PRODUCT",
          j."ACTION",
          j."COUNT",
          j."WITHINSLA",
          j."OUTOFSLA"
     FROM PROC_EXPORT_CUSTOMER_SERVICE_FCL j

8. PROC_EXPORT_CUSTOMER_SERVICE_FCL_DETAILS

SELECT ROWNUM id,
            sno,
            Dept,
            Product,
            Action,
            Ref_No,
            Ref_Date,
            Ref_Type,
            Ref_Mode,
            withinsla,
            outofsla
       FROM (SELECT 1 sno,
                            'Export Customer Service (FCL)' Dept,
                            'Sea Export' Product,
                            'Approved Quotations' Action,
                            RTEY_RATE_NO Ref_No,
                            RTEY_RATE_DATE Ref_Date,
                            RTEY_TYPE Ref_Type,
                            RTEY_RATE_TYPE Ref_Mode,
                            0 WithinSLA,
                            0 OutofSLA
                       FROM RTEY_RATE_ENTRY
                      WHERE RTEY_STATUS = 'Approved'
                      UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM ( SELECT 2 sno,
                              'Export Customer Service (FCL)' Dept,
                              'Sea Export' Product,
                              'New Nomination Routing Order' Action,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) <=
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) >
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a,
                              JMIL_MILESTONE b,
                              MDPT_DEPARTMENT c
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                              AND b.JMIL_NAME =
                                     'CONTACTED SHIPPER FOR CARGO READINESS'
                              AND a.JSHP_FREIGHT_MODE = 'Collect'
                              AND c.MDPT_RID = JSHP_MDPT
                              AND MDPT_SEA = 'Y'
                              AND c.MDPT_EXPORT = 'Y'
                              AND c.MDPT_FCL = 'Y'
                     GROUP BY   EXTRACT (
                                   HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                              - EXTRACT (
                                   HOUR FROM CAST (
                                                jshp_a_booking_date AS TIMESTAMP)),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE withinsla = 1
              UNION
              SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (
              SELECT 2 sno,
                              'Export Customer Service (FCL)' Dept,
                              'Sea Export' Product,
                              'New Nomination Routing Order' Action,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) <=
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) >
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                                 JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a,
                              JMIL_MILESTONE b,
                              MDPT_DEPARTMENT c
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                              AND b.JMIL_NAME =
                                     'CONTACTED SHIPPER FOR CARGO READINESS'
                              AND a.JSHP_FREIGHT_MODE = 'Collect'
                              AND c.MDPT_RID = JSHP_MDPT
                              AND MDPT_SEA = 'Y'
                              AND c.MDPT_EXPORT = 'Y'
                              AND c.MDPT_FCL = 'Y'
                     GROUP BY   EXTRACT (
                                   HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                              - EXTRACT (
                                   HOUR FROM CAST (
                                                jshp_a_booking_date AS TIMESTAMP)),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
                    WHERE outofsla = 1
              UNION
              SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 3 sno,
                            'Export Customer Service (FCL)' Dept,
                            'Sea Export' Product,
                            'SHIPMENT UNDER PROCESS' Action,
                            0 WithinSLA,
                            0 OutofSLA,
                            JSHP_HOUSE_BILL_NO,
                            JSHP_A_BOOKING_DATE,
                            JSHP_MPRT_DESTINATION,
                            JSHP_FREIGHT_MODE
                       FROM JSHP_SHIPMENT a,
                            JMIL_MILESTONE b,
                            MDPT_DEPARTMENT c
                      WHERE     UPPER (jshp_transport_mode) = 'SEA'
                            AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                            AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                            AND a.JSHP_SHIPPED_ON_BOARD_DATE IS NULL
                            AND b.JMIL_NAME =
                                   'SHIPPER CONTACTED FOR CARGO READINESS'
                            AND a.JSHP_SHIPMENT_STATUS = 'Active'
                            AND c.MDPT_RID = JSHP_MDPT
                            AND MDPT_SEA = 'Y'
                            AND c.MDPT_EXPORT = 'Y'
                            AND c.MDPT_FCL = 'Y')
                WHERE withinsla = 0
            UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 3 sno,
                            'Export Customer Service (FCL)' Dept,
                            'Sea Export' Product,
                            'SHIPMENT UNDER PROCESS' Action,
                            0 WithinSLA,
                            0 OutofSLA,
                            JSHP_HOUSE_BILL_NO,
                            JSHP_A_BOOKING_DATE,
                            JSHP_MPRT_DESTINATION,
                            JSHP_FREIGHT_MODE
                       FROM JSHP_SHIPMENT a,
                            JMIL_MILESTONE b,
                            MDPT_DEPARTMENT c
                      WHERE     UPPER (jshp_transport_mode) = 'SEA'
                            AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                            AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                            AND a.JSHP_SHIPPED_ON_BOARD_DATE IS NULL
                            AND b.JMIL_NAME =
                                   'SHIPPER CONTACTED FOR CARGO READINESS'
                            AND a.JSHP_SHIPMENT_STATUS = 'Active'
                            AND c.MDPT_RID = JSHP_MDPT
                            AND MDPT_SEA = 'Y'
                            AND c.MDPT_EXPORT = 'Y'
                            AND c.MDPT_FCL = 'Y')
                    WHERE outofsla = 0
            UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 4 sno,
                              'Export Customer Service (FCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG application(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) <= 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) > 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                                 JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
                WHERE withinsla = 1
            UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 4 sno,
                              'Export Customer Service (FCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG application(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) <= 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) > 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                                 JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
                WHERE outofsla = 1
            UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 5 sno,
                              'Export Customer Service (FCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG approval(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                                 JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b, MDPT_DEPARTMENT c
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NOT NULL
                              AND c.MDPT_RID = JSHP_MDPT
                              AND MDPT_SEA = 'Y'
                              AND c.MDPT_EXPORT = 'Y'
                              AND c.MDPT_FCL = 'Y'
                     GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_APPROVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
                    WHERE withinsla = 1
            UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 5 sno,
                              'Export Customer Service (FCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG approval(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                                 JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b, MDPT_DEPARTMENT c
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NOT NULL
                              AND c.MDPT_RID = JSHP_MDPT
                              AND MDPT_SEA = 'Y'
                              AND c.MDPT_EXPORT = 'Y'
                              AND c.MDPT_FCL = 'Y'
                     GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_APPROVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
                    WHERE outofsla = 1)
   GROUP BY ROWNUM,
            sno,
            Dept,
            Product,
            Action,
            Ref_No,
            Ref_Date,
            Ref_Type,
            Ref_Mode,
            withinsla,
            outofsla
   ORDER BY ROWNUM ASC

9. PROC_EXPORT_CUSTOMER_SERVICE_LCL

SELECT sno,
            dept,
            product,
            action,
            SUM (withinsla + outofsla) COUNT,
            CASE WHEN sno IN ('1', '3') THEN 0 ELSE SUM (withinsla) END
               withinsla,
            CASE WHEN sno IN ('1', '3') THEN 0 ELSE SUM (outofsla) END outofsla
       FROM (SELECT 1 sno,
                    'Export Customer Service (LCL)' Dept,
                    'Sea Export' Product,
                    'Approved Agent/Shipper Quotation' Action,
                    COUNT (*) WithinSLA,
                    0 OutofSLA
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
             UNION
               SELECT 2 sno,
                      'Export Customer Service (LCL)' Dept,
                      'Sea Export' Product,
                      'New Nomination Routing Order' Action,
                      CASE
                         WHEN (  EXTRACT (
                                    HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                               - EXTRACT (
                                    HOUR FROM CAST (
                                                 jshp_a_booking_date AS TIMESTAMP))) <=
                                 4
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         WithinSLA,
                      CASE
                         WHEN (  EXTRACT (
                                    HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                               - EXTRACT (
                                    HOUR FROM CAST (
                                                 jshp_a_booking_date AS TIMESTAMP))) >
                                 4
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         OutofSLA
                 FROM JSHP_SHIPMENT a, JMIL_MILESTONE b
                WHERE     UPPER (jshp_transport_mode) = 'SEA'
                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                      AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                      AND b.JMIL_NAME = 'CONTACTED SHIPPER FOR CARGO READINESS'
                      AND a.JSHP_FREIGHT_MODE = 'Collect'
             GROUP BY   EXTRACT (HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                      - EXTRACT (
                           HOUR FROM CAST (jshp_a_booking_date AS TIMESTAMP))
             UNION
             SELECT 3 sno,
                    'Export Customer Service (LCL)' Dept,
                    'Sea Export' Product,
                    'Shipment Under Process' Action,
                    COUNT (*) WithinSLA,
                    0 OutofSLA
               FROM JSHP_SHIPMENT a, JMIL_MILESTONE b, MDPT_DEPARTMENT c
              WHERE     UPPER (jshp_transport_mode) = 'SEA'
                    AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                    AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                    AND a.JSHP_SHIPPED_ON_BOARD_DATE IS NULL
                    AND b.JMIL_NAME = 'CONTACTED SHIPPER FOR CARGO READINESS'
                    AND a.JSHP_SHIPMENT_STATUS = 'Active'
                    AND c.MDPT_RID = JSHP_MDPT
                    AND MDPT_SEA = 'Y'
             UNION
               SELECT 4 sno,
                      'Export Customer Service (LCL)' Dept,
                      'Sea Export' Product,
                      'Pending Cargo Pickup' Action,
                      CASE
                         WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         WithinSLA,
                      CASE
                         WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         OutofSLA
                 FROM JSHP_SHIPMENT
                WHERE JSHP_E_RECEIVED_DATE IS NULL
             GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                      - TO_DATE (JSHP_E_RECEIVED_DATE)
             UNION
               SELECT 5 sno,
                      'Export Customer Service (LCL)' Dept,
                      'Sea Export' Product,
                      'Pending Cargo Receipt' Action,
                      CASE
                         WHEN   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE) <= 1
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         WithinSLA,
                      CASE
                         WHEN   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE) > 1
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         OutofSLA
                 FROM JSHP_SHIPMENT
                WHERE JSHP_CARGO_RECEIVED_DATE IS NULL
             GROUP BY   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE)
             UNION
               SELECT 6 sno,
                      'Export Customer Service (LCL)' Dept,
                      'Sea Export' Product,
                      'Pending DG Application' Action,
                      CASE
                         WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE) <= 5
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         WithinSLA,
                      CASE
                         WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE) > 5
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         OutofSLA
                 FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                WHERE a.JSHP_RID = b.JCUS_JSHP AND JCUS_DG_BOOKING_DATE IS NULL
             GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                      - TO_DATE (JCUS_DG_BOOKING_DATE)
             UNION
               SELECT 7 sno,
                      'Export Customer Service (LCL)' Dept,
                      'Sea Export' Product,
                      'Pending DG Approved' Action,
                      CASE
                         WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_APPROVED_DATE) <= 1
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         WithinSLA,
                      CASE
                         WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_APPROVED_DATE) > 1
                         THEN
                            COUNT (*)
                         ELSE
                            0
                      END
                         OutofSLA
                 FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                WHERE     a.JSHP_RID = b.JCUS_JSHP
                      AND JCUS_DG_BOOKING_DATE IS NOT NULL
             GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                      - TO_DATE (JCUS_DG_APPROVED_DATE)
             UNION
 SELECT 7 sno,
                    'Export Customer Service (LCL)' Dept,
                    'Sea Export' Product,
                    'Pending Export Customs Filing' Action,
                    COUNT (*) WithinSLA,
                    0 OutofSLA
               FROM
                jshp_shipment where jshp_inco = 'EXW' and JSHP_CLEARANCE_REQUIRED_DATE is null
                AND  UPPER (jshp_transport_mode) = 'SEA'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
    )
   GROUP BY sno,
            dept,
            product,
            action
   ORDER BY sno,
            dept,
            product,
            action

10. PROC_EXPORT_CUSTOMER_SERVICE_LCL_1

select ROWNUM AS ID , j."DEPT",j."PRODUCT",j."ACTION",j."COUNT",j."WITHINSLA",j."OUTOFSLA" from  PROC_EXPORT_CUSTOMER_SERVICE_LCL j

11.  PROC_EXPORT_CUSTOMER_SERVICE_LCL_DETAILSSELECT ROWNUM id,
            sno,
            Dept,
            Product,
            Action,
            Ref_No,
            Ref_Date,
            Ref_Type,
            Ref_Mode,
            withinsla,
            outofsla
       FROM (SELECT 1 sno,
                    'Export Customer Service (LCL)' Dept,
                    'Sea Export' Product,
                    'Approved Agent/Shipper Quotation' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    0 withinsla,
                    0 outofsla
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 2 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'New Nomination Routing Order' Action,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) <=
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) >
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JMIL_MILESTONE b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                              AND b.JMIL_NAME =
                                     'CONTACTED SHIPPER FOR CARGO READINESS'
                              AND a.JSHP_FREIGHT_MODE = 'Collect'
                     GROUP BY   EXTRACT (
                                   HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                              - EXTRACT (
                                   HOUR FROM CAST (
                                                jshp_a_booking_date AS TIMESTAMP)),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 2 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'New Nomination Routing Order' Action,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) <=
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) >
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JMIL_MILESTONE b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                              AND b.JMIL_NAME =
                                     'CONTACTED SHIPPER FOR CARGO READINESS'
                              AND a.JSHP_FREIGHT_MODE = 'Collect'
                     GROUP BY   EXTRACT (
                                   HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                              - EXTRACT (
                                   HOUR FROM CAST (
                                                jshp_a_booking_date AS TIMESTAMP)),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE outofsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 3 sno,
                            'Export Customer Service (LCL)' Dept,
                            'Sea Export' Product,
                            'Shipment Under Process' Action,
                            0 WithinSLA,
                            0 outofsla,
                            JSHP_HOUSE_BILL_NO,
                            JSHP_A_BOOKING_DATE,
                            JSHP_MPRT_DESTINATION,
                            JSHP_FREIGHT_MODE
                       FROM JSHP_SHIPMENT a,
                            JMIL_MILESTONE b,
                            MDPT_DEPARTMENT c
                      WHERE     UPPER (jshp_transport_mode) = 'SEA'
                            AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                            AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                            AND a.JSHP_SHIPPED_ON_BOARD_DATE IS NULL
                            AND b.JMIL_NAME =
                                   'CONTACTED SHIPPER FOR CARGO READINESS'
                            AND a.JSHP_SHIPMENT_STATUS = 'Active'
                            AND c.MDPT_RID = JSHP_MDPT
                            AND MDPT_SEA = 'Y')
              WHERE withinsla = 0
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 3 sno,
                            'Export Customer Service (LCL)' Dept,
                            'Sea Export' Product,
                            'Shipment Under Process' Action,
                            0 WithinSLA,
                            0 outofsla,
                            JSHP_HOUSE_BILL_NO,
                            JSHP_A_BOOKING_DATE,
                            JSHP_MPRT_DESTINATION,
                            JSHP_FREIGHT_MODE
                       FROM JSHP_SHIPMENT a,
                            JMIL_MILESTONE b,
                            MDPT_DEPARTMENT c
                      WHERE     UPPER (jshp_transport_mode) = 'SEA'
                            AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                            AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                            AND a.JSHP_SHIPPED_ON_BOARD_DATE IS NULL
                            AND b.JMIL_NAME =
                                   'CONTACTED SHIPPER FOR CARGO READINESS'
                            AND a.JSHP_SHIPMENT_STATUS = 'Active'
                            AND c.MDPT_RID = JSHP_MDPT
                            AND MDPT_SEA = 'Y')
              WHERE outofsla = 0
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 4 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'Pending Cargo Pickup' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 4 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'Pending Cargo Pickup' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE outofsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 5 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'Pending Cargo receipt' Action,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_CARGO_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 5 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'Pending Cargo receipt' Action,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND JSHP_CARGO_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE outofsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 6 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG application(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) <= 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) > 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NULL
                     GROUP BY JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE,
                                TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE))
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 6 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG application(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) <= 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) > 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NULL
                     GROUP BY JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE,
                                TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE))
              WHERE outofsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 7 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG approval(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NOT NULL
                     GROUP BY JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE,
                                TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_APPROVED_DATE))
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 7 sno,
                              'Export Customer Service (LCL)' Dept,
                              'Sea Export' Product,
                              'Pending DG approval(If applicable)' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NOT NULL
                     GROUP BY JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE,
                                TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_APPROVED_DATE))
              WHERE outofsla = 1)
   GROUP BY ROWNUM,
            sno,
            Dept,
            Product,
            Action,
            Ref_No,
            Ref_Date,
            Ref_Type,
            Ref_Mode,
            withinsla,
            outofsla
   ORDER BY ROWNUM ASC

12. PROC_EXPORT_DOCUMENTATION_AIR

SELECT ROWNUM id,
          dept,
          product,
          action,
          COUNT,
          withinsla,
          outofsla
     FROM (SELECT dept,
                  product,
                  action,
                  CASE WHEN COUNT IS NULL THEN 0 ELSE COUNT END COUNT,
                  CASE WHEN withinsla IS NULL THEN 0 ELSE withinsla END
                     withinsla,
                  CASE WHEN outofsla IS NULL THEN 0 ELSE outofsla END
                     outofsla
             FROM (  SELECT sno,
                            dept,
                            product,
                            action,
                            SUM (withinsla + outofsla) COUNT,
                            CASE
                               WHEN sno IN ('1') THEN 0
                               ELSE SUM (withinsla)
                            END
                               withinsla,
                            CASE
                               WHEN sno IN ('1') THEN 0
                               ELSE SUM (outofsla)
                            END
                               outofsla
                       FROM (SELECT 1 sno,
                                    'Export Documentation' Dept,
                                    'Air Export' Product,
                                    'Receipt of Shipping Instructions(SLI)' Action,
                                    COUNT (*) WithinSLA,
                                    0 OutofSLA
                               FROM JSHP_SHIPMENT
                              WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                    AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                                    AND JSHP_RELEASE_TYPE IS NULL
                                    AND JSHP_HOUSE_BILL_NO IS NOT NULL
                             UNION
                               SELECT 2 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending HAWB Drafts'
                                         Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JSHP_E_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) <= 2
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JSHP_E_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 2
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JSHP_SHIPMENT
                                WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                                      AND JSHP_RELEASE_TYPE = 'Draft'
                                      AND JSHP_HOUSE_BILL_NO IS NOT NULL
                             GROUP BY JSHP_HOUSE_BILL_NO,
                                      JSHP_A_BOOKING_DATE,
                                      JSHP_MPRT_DESTINATION,
                                      JSHP_FREIGHT_MODE,
                                        TO_DATE (JSHP_E_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                               SELECT 3 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending HBL Drafts approval' Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JSHP_E_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) <= 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JSHP_E_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JSHP_SHIPMENT
                                WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                                      AND NVL (JSHP_RELEASE_TYPE, 'null') NOT IN
                                             ('Draft', 'null')
                                      AND JSHP_HOUSE_BILL_NO IS NOT NULL
                             GROUP BY JSHP_HOUSE_BILL_NO,
                                      JSHP_A_BOOKING_DATE,
                                      JSHP_MPRT_DESTINATION,
                                      JSHP_FREIGHT_MODE,
                                        TO_DATE (JSHP_E_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                               SELECT 4 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending for Carrier Cost Entry' Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) <= 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JMST_MASTER a, JCHG_CHARGE b
                                WHERE     UPPER (JMST_transport_mode) = 'AIR'
                                      AND JMST_RID = JCHG_JMST
                                      AND JMST_OADR_SHIPPING_LINE =
                                             JCHG_ORGN_COST_PARTY
                             GROUP BY JMST_MASTER_BILL_NO,
                                      JMST_MASTER_BILL_ISSUED_DATE,
                                      JMST_CONSOL_MODE,
                                      JMST_TRANSPORT_MODE,
                                        TO_DATE (JMST_A_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                               SELECT 5 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending for Transporter Cost Entry' Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) <= 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JMST_MASTER a, JCHG_CHARGE b
                                WHERE     UPPER (jmst_transport_mode) = 'AIR'
                                      AND JMST_RID = JCHG_JMST
                                      AND JMST_ORGN_PACK_TRANSPORTOR =
                                             JCHG_ORGN_COST_PARTY
                                      AND JMST_MASTER_BILL_NO IS NOT NULL
                             GROUP BY JMST_MASTER_BILL_NO,
                                      JMST_MASTER_BILL_ISSUED_DATE,
                                      JMST_CONSOL_MODE,
                                      JMST_TRANSPORT_MODE,
                                        TO_DATE (JMST_A_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                               SELECT 6 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending for other vendor cost entry'
                                         Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) <= 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JMST_MASTER a, JCHG_CHARGE b
                                WHERE     UPPER (jmst_transport_mode) = 'AIR'
                                      AND JMST_RID = JCHG_JMST
                                      AND JMST_MASTER_BILL_NO IS NOT NULL
                                      AND JMST_ORGN_PACK_TRANSPORTOR =
                                             JCHG_ORGN_COST_PARTY
                             GROUP BY JMST_MASTER_BILL_NO,
                                      JMST_MASTER_BILL_ISSUED_DATE,
                                      JMST_CONSOL_MODE,
                                      JMST_TRANSPORT_MODE,
                                        TO_DATE (JMST_A_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                               SELECT 7 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending for Carrier Payment' Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) <= 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JMST_MASTER a, JCHG_CHARGE b
                                WHERE     UPPER (jmst_transport_mode) = 'AIR'
                                      AND JMST_RID = JCHG_JMST
                                      AND JMST_OADR_SHIPPING_LINE =
                                             JCHG_ORGN_COST_PARTY
                                      AND JMST_MASTER_BILL_NO IS NOT NULL
                             GROUP BY JMST_MASTER_BILL_NO,
                                      JMST_MASTER_BILL_ISSUED_DATE,
                                      JMST_CONSOL_MODE,
                                      JMST_TRANSPORT_MODE,
                                        TO_DATE (JMST_A_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                               SELECT 8 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending for Overseas Invoice' Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JSHP_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) <= 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JSHP_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JSHP_SHIPMENT a, JCHG_CHARGE b
                                WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                                      AND JSHP_RID = JCHG_JMST
                                      AND JSHP_OADR_AGENT_COLLECT =
                                             JCHG_ORGN_SALE_PARTY
                                      AND JSHP_HOUSE_BILL_NO IS NOT NULL
                             GROUP BY JSHP_HOUSE_BILL_NO,
                                      JSHP_A_BOOKING_DATE,
                                      JSHP_MPRT_DESTINATION,
                                      JSHP_FREIGHT_MODE,
                                        TO_DATE (JSHP_A_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                               SELECT 9 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending for Local Sales Invoice' Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JSHP_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) <= 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JSHP_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JSHP_SHIPMENT a, JCHG_CHARGE b
                                WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'EXPORT'
                                      AND JSHP_RID = JCHG_JMST
                                      AND JSHP_OADR_LOCAL_BILLING =
                                             JCHG_ORGN_SALE_PARTY
                                      AND JSHP_HOUSE_BILL_NO IS NOT NULL
                             GROUP BY JSHP_HOUSE_BILL_NO,
                                      JSHP_A_BOOKING_DATE,
                                      JSHP_MPRT_DESTINATION,
                                      JSHP_FREIGHT_MODE,
                                        TO_DATE (JSHP_A_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                               SELECT 10 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending MAWB/HAWB print' Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) = 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JMST_MASTER a
                                WHERE     UPPER (jmst_transport_mode) = 'AIR'
                                      AND JMST_MASTER_BILL_NO IS NOT NULL
                             GROUP BY JMST_MASTER_BILL_NO,
                                      JMST_MASTER_BILL_ISSUED_DATE,
                                      JMST_CONSOL_MODE,
                                      JMST_TRANSPORT_MODE,
                                        TO_DATE (JMST_A_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                               SELECT 11 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending Pre-alert to destination agent' Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) = 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 1
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JMST_MASTER a
                                WHERE     UPPER (jmst_transport_mode) = 'AIR'
                                      AND JMST_MASTER_BILL_NO IS NOT NULL
                             GROUP BY JMST_MASTER_BILL_NO,
                                      JMST_MASTER_BILL_ISSUED_DATE,
                                      JMST_CONSOL_MODE,
                                      JMST_TRANSPORT_MODE,
                                        TO_DATE (JMST_A_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE)
                             UNION
                             SELECT 12 sno,
                                    'Export Documentation' Dept,
                                    'Air Export' Product,
                                    'Pending Post Shipment documents to SHPR'
                                       Action,
                                    0 withinsla,
                                    0 outofsla
                               FROM DUAL
                             UNION
                               SELECT 13 sno,
                                      'Export Documentation' Dept,
                                      'Air Export' Product,
                                      'Pending DOC Completion' Action,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) < 7
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         WithinSLA,
                                      SUM (
                                         CASE
                                            WHEN   TO_DATE (
                                                      JMST_A_DEPARTURE_DATE)
                                                 - TO_DATE (SYSDATE) > 7
                                            THEN
                                               COUNT (*)
                                            ELSE
                                               0
                                         END)
                                         OutofSLA
                                 FROM JMST_MASTER a
                                WHERE     UPPER (jmst_transport_mode) = 'AIR'
                                      AND JMST_MASTER_BILL_NO IS NOT NULL
                             GROUP BY JMST_MASTER_BILL_NO,
                                      JMST_MASTER_BILL_ISSUED_DATE,
                                      JMST_CONSOL_MODE,
                                      JMST_TRANSPORT_MODE,
                                        TO_DATE (JMST_A_DEPARTURE_DATE)
                                      - TO_DATE (SYSDATE))
                   GROUP BY sno,
                            dept,
                            product,
                            action
                   ORDER BY sno,
                            dept,
                            product,
                            action))

13. PROC_EXPORT_SALES_SUPPORT

SELECT sno id,
          DEPT,
          PRODUCT,
          ACTION,
          COUNT,Within_Expiry_Date,Exceeded_Expiry_Date
     FROM (
              select sno,dept,product,action,(within_expiry_date+Exceeded_Expiry_Date) count,Within_Expiry_Date,Exceeded_Expiry_Date from(
     select sno,dept,product,action,sum(Within_Expiry_date) Within_Expiry_Date,sum(Exceeded_Expiry_Date) Exceeded_Expiry_Date from(     
     SELECT 1 sno,
                  'Sales Support' Dept,
                  'Sea Export' Product,
                  'Active Quotations' Action,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
             FROM RTEY_RATE_ENTRY
            WHERE RTEY_STATUS IN (NULL, 'Pending') group by to_date(RTEY_EXPIRY_DATE)-to_date(sysdate))group by sno,dept,product,action)
            UNION
           select sno,dept,product,action,(within_expiry_date+Exceeded_Expiry_Date) count,Within_Expiry_Date,Exceeded_Expiry_Date from(
     select sno,dept,product,action,sum(Within_Expiry_date) Within_Expiry_Date,sum(Exceeded_Expiry_Date) Exceeded_Expiry_Date from(     
     SELECT 2 sno,
                  'Sales Support' Dept,
                  'Sea Export' Product,
                  'Approved Quotations' Action,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
             FROM RTEY_RATE_ENTRY
            WHERE RTEY_STATUS IN ('Approved') group by RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate))group by sno,dept,product,action))

14. PROC_EXPORT_SALES_SUPPORT_AIR
SELECT sno id,
          DEPT,
          PRODUCT,
          ACTION,
          COUNT,Within_Expiry_Date,Exceeded_Expiry_Date
     FROM (
              select sno,dept,product,action,(within_expiry_date+Exceeded_Expiry_Date) count,Within_Expiry_Date,Exceeded_Expiry_Date from(
     select sno,dept,product,action,sum(Within_Expiry_date) Within_Expiry_Date,sum(Exceeded_Expiry_Date) Exceeded_Expiry_Date from(     
     SELECT 1 sno,
                  'Sales Support' Dept,
                  'Air Export' Product,
                  'Active Quotations' Action,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
             FROM RTEY_RATE_ENTRY
            WHERE RTEY_STATUS IN (NULL, 'Pending') group by to_date(RTEY_EXPIRY_DATE)-to_date(sysdate))group by sno,dept,product,action)
            UNION
           select sno,dept,product,action,(within_expiry_date+Exceeded_Expiry_Date) count,Within_Expiry_Date,Exceeded_Expiry_Date from(
     select sno,dept,product,action,sum(Within_Expiry_date) Within_Expiry_Date,sum(Exceeded_Expiry_Date) Exceeded_Expiry_Date from(     
     SELECT 2 sno,
                  'Sales Support' Dept,
                  'Air Export' Product,
                  'Approved Quotations' Action,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
             FROM RTEY_RATE_ENTRY
            WHERE RTEY_STATUS IN ('Approved') group by RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate))group by sno,dept,product,action))

15. PROC_EXPORT_SALES_SUPPORT_DETAILS

SELECT ROWNUM id,
          sno,
          dept,
          product,
          action,
          ref_no,
          ref_date,
          ref_type,
          ref_mode
     FROM (            
     select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(
          SELECT 1 sno,
                    'Sales Support' Dept,
                    'Sea Export' Product,
                    'Active Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS IN (NULL, 'Pending')
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)) where Within_Expiry_date>0
                    union
                      select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(
          SELECT 1 sno,
                    'Sales Support' Dept,
                    'Sea Export' Product,
                    'Active Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS IN (NULL, 'Pending')
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)) where Exceeded_Expiry_Date>0
                               UNION
                      select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(          
             SELECT 2 sno,
                    'Sales Support' Dept,
                    'Sea Export' Product,
                    'Approved Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                     case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate) 
                                        )  where Within_Expiry_date>0 
                                        union
           select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(          
             SELECT 2 sno,
                    'Sales Support' Dept,
                    'Sea Export' Product,
                    'Approved Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                     case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate) 
                                        )  where Exceeded_Expiry_Date>0 )

16. PROC_EXPORT_SALES_SUPPORT_DETAILS_AIR

SELECT ROWNUM id,
          sno,
          dept,
          product,
          action,
          ref_no,
          ref_date,
          ref_type,
          ref_mode
     FROM (            
     select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(
          SELECT 1 sno,
                    'Sales Support' Dept,
                    'Air Export' Product,
                    'Active Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS IN (NULL, 'Pending')
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)) where Within_Expiry_date>0
                    union
                      select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(
          SELECT 1 sno,
                    'Sales Support' Dept,
                    'Air Export' Product,
                    'Active Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS IN (NULL, 'Pending')
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)) where Exceeded_Expiry_Date>0
                               UNION
                      select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(          
             SELECT 2 sno,
                    'Sales Support' Dept,
                    'Air Export' Product,
                    'Approved Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                     case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate) 
                                        )  where Within_Expiry_date>0 
                                        union
           select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(          
             SELECT 2 sno,
                    'Sales Support' Dept,
                    'Air Export' Product,
                    'Approved Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                     case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate) 
                                        )  where Exceeded_Expiry_Date>0 )

17. PROC_IMPORT_CUSTOMER_SERVICE_AIR

SELECT id,
          dept,
          product,
          action,
          CASE WHEN COUNT IS NULL THEN 0 ELSE COUNT END COUNT,
          CASE WHEN withinsla IS NULL THEN 0 ELSE withinsla END withinsla,
          CASE WHEN outofsla IS NULL THEN 0 ELSE outofsla END outofsla
     FROM (  SELECT sno id,
                    dept,
                    product,
                    action,
                    SUM (withinsla + outofsla) COUNT,
                    CASE WHEN sno IN (1, 3) THEN 0 ELSE SUM (withinsla) END
                       withinsla,
                    CASE WHEN sno IN (1, 3) THEN 0 ELSE SUM (outofsla) END
                       outofsla
               FROM (SELECT 1 sno,
                            'Import Customer Service' Dept,
                            'Air Import' Product,
                            'Approved Agent/Shipper Quotation' Action,
                            COUNT (*) WithinSLA,
                            0 OutofSLA
                       FROM RTEY_RATE_ENTRY
                      WHERE RTEY_STATUS = 'Approved'
                     UNION
                       SELECT sno,
                              dept,
                              product,
                              action,
                              SUM (withinsla) withinsla,
                              SUM (outofsla) outofsla
                         FROM (  SELECT 2 sno,
                                        'Import Customer Service' Dept,
                                        'Air Import' Product,
                                        'New Nomination Routing Order' Action,
                                        CASE
                                           WHEN   EXTRACT (
                                                     HOUR FROM CAST (
                                                                  a.updated_date AS TIMESTAMP))
                                                - EXTRACT (
                                                     HOUR FROM CAST (
                                                                  jshp_a_booking_date AS TIMESTAMP)) <=
                                                   4
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           WithinSLA,
                                        CASE
                                           WHEN   EXTRACT (
                                                     HOUR FROM CAST (
                                                                  a.updated_date AS TIMESTAMP))
                                                - EXTRACT (
                                                     HOUR FROM CAST (
                                                                  jshp_a_booking_date AS TIMESTAMP)) >
                                                   4
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           OutofSLA
                                   FROM JSHP_SHIPMENT a, JMIL_MILESTONE b
                                  WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                                        AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                                        AND b.JMIL_NAME =
                                               'CONTACTED SHIPPER FOR CARGO READINESS'
                                        AND a.JSHP_FREIGHT_MODE = 'Collect'
                               GROUP BY   EXTRACT (
                                             HOUR FROM CAST (
                                                          a.updated_date AS TIMESTAMP))
                                        - EXTRACT (
                                             HOUR FROM CAST (
                                                          jshp_a_booking_date AS TIMESTAMP)))
                     GROUP BY sno,
                              dept,
                              product,
                              action
                     UNION
                       SELECT 3 sno,
                              'Import Customer Service' Dept,
                              'Air Import' Product,
                              'Pending Carrier Booking' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE)
                     UNION
                       SELECT 4 sno,
                              'Import Customer Service' Dept,
                              'Air Import' Product,
                              'Pending Flight details update' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE)
                     UNION
                       SELECT 5 sno,
                              'Import Customer Service' Dept,
                              'Air Import' Product,
                              'Master Job Creation/Listing' Action,
                              0 withinsla,
                              0 outofsla
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE)
                     UNION
                       SELECT 6 sno,
                              'Import Customer Service' Dept,
                              'Air Import' Product,
                              'Shipment Under Process' Action,
                              0 withinsla,
                              0 outofsla
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_CARGO_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE)
                     UNION
                       SELECT 7 sno,
                              'Import Customer Service' Dept,
                              'Air Import' Product,
                              'Pending Cargo Pickup' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_E_DEPARTURE_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE)
                     UNION
                       SELECT 8 sno,
                              'Import Customer Service' Dept,
                              'Air Import' Product,
                              'Pending Cargo Receipt' Acltion,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_CARGO_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE)
                     UNION
                       SELECT 9 sno,
                              'Import Customer Service' Dept,
                              'Air Import' Product,
                              'Pending DG application' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE)
                     UNION
                       SELECT sno,
                              dept,
                              product,
                              action,
                              SUM (withinsla) withinsla,
                              SUM (outofsla) outofsla
                         FROM (  SELECT 10 sno,
                                        'Import Customer Service' Dept,
                                        'Air Import' Product,
                                        'Pending DG Approval' Action,
                                        CASE
                                           WHEN   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                                - TO_DATE (JCUS_DG_APPROVED_DATE) <=
                                                   1
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           WithinSLA,
                                        CASE
                                           WHEN   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                                - TO_DATE (JCUS_DG_APPROVED_DATE) >
                                                   1
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           OutofSLA
                                   FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                                  WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                                        AND a.JSHP_RID = b.JCUS_JSHP
                                        AND JCUS_DG_BOOKING_DATE IS NOT NULL
                               GROUP BY   TO_DATE (JSHP_E_DEPARTURE_DATE)
                                        - TO_DATE (JCUS_DG_APPROVED_DATE))
                     GROUP BY sno,
                              dept,
                              product,
                              action)
           GROUP BY sno,
                    dept,
                    product,
                    action
           ORDER BY sno ASC)

18. PROC_IMPORT_CUSTOMER_SERVICE_FCL
SELECT sno id,
          dept,
          product,
          action,
          CASE WHEN COUNT IS NULL THEN 0 ELSE COUNT END COUNT,
          CASE WHEN withinsla IS NULL THEN 0 ELSE withinsla END withinsla,
          CASE WHEN outofsla IS NULL THEN 0 ELSE outofsla END outofsla
     FROM (  SELECT sno,
                    dept,
                    product,
                    action,
                    SUM (withinsla + outofsla) COUNT,
                    CASE WHEN sno IN (1) THEN 0 ELSE SUM (withinsla) END
                       withinsla,
                    CASE WHEN sno IN (1) THEN 0 ELSE SUM (outofsla) END
                       outofsla
               FROM (
               SELECT 1 sno,
                            'Import Customer Service (FCL)' Dept,
                            'Sea Import' Product,
                            'Approved Quotation List (Booking Order)in FCL' Action,
                            COUNT (*) WithinSLA,
                            0 OutofSLA
                       FROM RTEY_RATE_ENTRY
                      WHERE RTEY_STATUS = 'Approved'
                     UNION
SELECT 2 sno,
                              'Import Customer Service (FCL)' Dept,
                              'Sea Import' Product,
                              'Pending Routing Order Trigger' Action,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) <=
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) >
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT a,
                              JMIL_MILESTONE b,
                              MDPT_DEPARTMENT c
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                              AND b.JMIL_NAME =
                                     'CONTACTED SHIPPER FOR CARGO READINESS'
                              AND a.JSHP_FREIGHT_MODE = 'Collect'
                              AND c.MDPT_RID = JSHP_MDPT
                              AND MDPT_SEA = 'Y'
                              AND c.MDPT_EXPORT = 'Y'
                              AND c.MDPT_FCL = 'Y'
                     GROUP BY   EXTRACT (
                                   HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                              - EXTRACT (
                                   HOUR FROM CAST (
                                                jshp_a_booking_date AS TIMESTAMP))
                     UNION
SELECT 3 sno,
                            'Import Customer Service (FCL)' Dept,
                            'Sea Import' Product,
                            'Pending to Contact Shipper' Action,
                            count(jshp_rid) WithinSLA,
                            0 OutofSLA
                       FROM JSHP_SHIPMENT a
                                where UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                               and jshp_house_bill_no not in (select jmil_hbl 
from jmil_milestone where jmil_name = 'CONTACTED SHIPPER FOR CARGO READINESS')
and JSHP_FREIGHT_MODE = 'Collect'
UNION
SELECT 4 sno,
                            'Import Customer Service (FCL)' Dept,
                            'Sea Import' Product,
                            'Pending SOB update' Action,
                            count(jshp_rid) WithinSLA,
                            0 OutofSLA
                       FROM JSHP_SHIPMENT a
                                where UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              and  jshp_house_bill_no not in (select jmil_hbl 
from jmil_milestone where jmil_name = 'SHIPPED ON BOARD')
and JSHP_FREIGHT_MODE = 'Collect'
UNION
SELECT 5 sno,
                            'Import Customer Service (FCL)' Dept,
                            'Sea Import' Product,
                            'Pending CAN' Action,
                            count(jshp_rid) WithinSLA,
                            0 OutofSLA
                       FROM JSHP_SHIPMENT a
                                where UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                         --   and jshp_can_date is null
UNION
SELECT 6 sno,
                            'Import Customer Service (FCL)' Dept,
                            'Sea Import' Product,
                            'Pending DO' Action,
                            count(jshp_rid) WithinSLA,
                            0 OutofSLA
                       FROM JSHP_SHIPMENT a
                                where UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              and JSHP_DO_NO is null
)
           GROUP BY sno,
                    dept,
                    product,
                    action
           ORDER BY sno,
                    dept,
                    product,
                    action)


19. PROC_IMPORT_CUSTOMER_SERVICE_LCL

SELECT sno id,
          dept,
          product,
          action,
          CASE WHEN COUNT IS NULL THEN 0 ELSE COUNT END COUNT,
          CASE WHEN withinsla IS NULL THEN 0 ELSE withinsla END withinsla,
          CASE WHEN outofsla IS NULL THEN 0 ELSE outofsla END outofsla
     FROM (  SELECT sno,
                    dept,
                    product,
                    action,
                    SUM (withinsla + outofsla) COUNT,
                    CASE WHEN sno IN (1) THEN 0 ELSE SUM (withinsla) END
                       withinsla,
                    CASE WHEN sno IN (1) THEN 0 ELSE SUM (outofsla) END
                       outofsla
               FROM (
               SELECT 1 sno,
                            'Import Customer Service (LCL)' Dept,
                            'Sea Import' Product,
                            'Approved Quotation List (Booking Order) in LCL' Action,
                            COUNT (*) WithinSLA,
                            0 OutofSLA
                       FROM RTEY_RATE_ENTRY
                      WHERE RTEY_STATUS = 'Approved'
                     UNION
                       SELECT sno,
                              dept,
                              product,
                              action,
                              SUM (withinsla) withinsla,
                              SUM (outofsla) outofsla
                         FROM (  SELECT 2 sno,
                                        'Import Customer Service (LCL)' Dept,
                                        'Sea Import' Product,
                                        'Pending Routing Order Trigger' Action,
                                        CASE
                                           WHEN   EXTRACT (
                                                     HOUR FROM CAST (
                                                                  a.updated_date AS TIMESTAMP))
                                                - EXTRACT (
                                                     HOUR FROM CAST (
                                                                  jshp_a_booking_date AS TIMESTAMP)) <=
                                                   4
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           WithinSLA,
                                        CASE
                                           WHEN   EXTRACT (
                                                     HOUR FROM CAST (
                                                                  a.updated_date AS TIMESTAMP))
                                                - EXTRACT (
                                                     HOUR FROM CAST (
                                                                  jshp_a_booking_date AS TIMESTAMP)) >
                                                   4
                                           THEN
                                              COUNT (*)
                                           ELSE
                                              0
                                        END
                                           OutofSLA
                                   FROM JSHP_SHIPMENT a, JMIL_MILESTONE b
                                  WHERE     UPPER (jshp_transport_mode) = 'SEA'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                                        AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                                        AND b.JMIL_NAME =
                                               'CONTACTED SHIPPER FOR CARGO READINESS'
                                        AND a.JSHP_FREIGHT_MODE = 'Collect'
                               GROUP BY   EXTRACT (
                                             HOUR FROM CAST (
                                                          a.updated_date AS TIMESTAMP))
                                        - EXTRACT (
                                             HOUR FROM CAST (
                                                          jshp_a_booking_date AS TIMESTAMP)))
                     GROUP BY sno,
                              dept,
                              product,
                              action
                     UNION
SELECT 3 sno,
                            'Import Customer Service (LCL)' Dept,
                            'Sea Import' Product,
                            'Pending to Contact Shipper' Action,
                            count(jshp_rid) WithinSLA,
                            0 OutofSLA
                       FROM  jshp_shipment
where jshp_house_bill_no not in (select jmil_hbl 
from jmil_milestone where jmil_name = 'CONTACTED SHIPPER FOR CARGO READINESS')
and JSHP_FREIGHT_MODE = 'Collect' 
 AND UPPER (jshp_transport_mode) = 'SEA'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
UNION
SELECT 4 sno,
                            'Import Customer Service (LCL)' Dept,
                            'Sea Import' Product,
                            'Pending Cargo receipt' Action,
                            count(jshp_rid) WithinSLA,
                            0 OutofSLA
                       FROM  jshp_shipment
                                      WHERE UPPER (jshp_transport_mode) = 'SEA'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'  
                                        AND jshp_house_bill_no not in (select jmil_hbl 
from jmil_milestone where jmil_name = 'CARGO RECEIVED AT CFS')
and JSHP_FREIGHT_MODE = 'Collect'
UNION
SELECT 5 sno,
                            'Import Customer Service (LCL)' Dept,
                            'Sea Import' Product,
                            'Pending SOB update' Action,
                            count(jshp_rid) WithinSLA,
                            0 OutofSLA
                       FROM  jshp_shipment
                                      WHERE UPPER (jshp_transport_mode) = 'SEA'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'  
                                    AND  jshp_house_bill_no not in (select jmil_hbl 
from jmil_milestone where jmil_name = 'SHIPPED ON BOARD')
and JSHP_FREIGHT_MODE = 'Collect'
UNION
SELECT 6 sno,
                            'Import Customer Service (LCL)' Dept,
                            'Sea Import' Product,
                            'Pending CAN' Action,
                            count(jshp_rid) WithinSLA,
                            0 OutofSLA
                       FROM  jshp_shipment
                                      WHERE UPPER (jshp_transport_mode) = 'SEA'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT' 
                                       --and jshp_can_date is null
UNION
SELECT 7 sno,
                            'Import Customer Service (LCL)' Dept,
                            'Sea Import' Product,
                            'Pending DO' Action,
                            count(jshp_rid) WithinSLA,
                            0 OutofSLA
                       FROM  jshp_shipment
                                      WHERE UPPER (jshp_transport_mode) = 'SEA'
                                        AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT' 
                                        and JSHP_DO_NO is null                                      
               )
                     GROUP BY sno,
                              dept,
                              product,
                              action)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    CASE WHEN COUNT IS NULL THEN 0 ELSE COUNT END,
          CASE WHEN withinsla IS NULL THEN 0 ELSE withinsla END,
          CASE WHEN outofsla IS NULL THEN 0 ELSE outofsla END
           ORDER BY sno,
                    dept,
                    product,
                    action


20 . PROC_IMPORT_CUSTOMER_SERVICE_LCL_DETAILS

SELECT ROWNUM id,
            sno,
            Dept,
            Product,
            Action,
            Ref_No,
            Ref_Date,
            Ref_Type,
            Ref_Mode,
            withinsla,
            outofsla
       FROM (SELECT 1 sno,
                    'Import Customer Service (LCL)' Dept,
                    'Sea Import' Product,
                    'Approved Agent/Shipper Quotation' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    0 withinsla,
                    0 outofsla
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 2 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'New Nomination Routing Order' Action,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) <=
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) >
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JMIL_MILESTONE b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                              AND b.JMIL_NAME =
                                     'CONTACTED SHIPPER FOR CARGO READINESS'
                              AND a.JSHP_FREIGHT_MODE = 'Collect'
                     GROUP BY   EXTRACT (
                                   HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                              - EXTRACT (
                                   HOUR FROM CAST (
                                                jshp_a_booking_date AS TIMESTAMP)),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 2 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'New Nomination Routing Order' Action,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) <=
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   EXTRACT (
                                           HOUR FROM CAST (
                                                        a.updated_date AS TIMESTAMP))
                                      - EXTRACT (
                                           HOUR FROM CAST (
                                                        jshp_a_booking_date AS TIMESTAMP)) >
                                         4
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JMIL_MILESTONE b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                              AND b.JMIL_NAME =
                                     'CONTACTED SHIPPER FOR CARGO READINESS'
                              AND a.JSHP_FREIGHT_MODE = 'Collect'
                     GROUP BY   EXTRACT (
                                   HOUR FROM CAST (a.updated_date AS TIMESTAMP))
                              - EXTRACT (
                                   HOUR FROM CAST (
                                                jshp_a_booking_date AS TIMESTAMP)),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE outofsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 3 sno,
                            'Import Customer Service (LCL)' Dept,
                            'Sea Import' Product,
                            'Shipment Under Process' Action,
                            0 WithinSLA,
                            0 outofsla,
                            JSHP_HOUSE_BILL_NO,
                            JSHP_A_BOOKING_DATE,
                            JSHP_MPRT_DESTINATION,
                            JSHP_FREIGHT_MODE
                       FROM JSHP_SHIPMENT a,
                            JMIL_MILESTONE b,
                            MDPT_DEPARTMENT c
                      WHERE     UPPER (jshp_transport_mode) = 'SEA'
                            AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                            AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                            AND a.JSHP_SHIPPED_ON_BOARD_DATE IS NULL
                            AND b.JMIL_NAME =
                                   'CONTACTED SHIPPER FOR CARGO READINESS'
                            AND a.JSHP_SHIPMENT_STATUS = 'Active'
                            AND c.MDPT_RID = JSHP_MDPT
                            AND MDPT_SEA = 'Y')
              WHERE withinsla = 0
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (SELECT 3 sno,
                            'Import Customer Service (LCL)' Dept,
                            'Sea Import' Product,
                            'Shipment Under Process' Action,
                            0 WithinSLA,
                            0 outofsla,
                            JSHP_HOUSE_BILL_NO,
                            JSHP_A_BOOKING_DATE,
                            JSHP_MPRT_DESTINATION,
                            JSHP_FREIGHT_MODE
                       FROM JSHP_SHIPMENT a,
                            JMIL_MILESTONE b,
                            MDPT_DEPARTMENT c
                      WHERE     UPPER (jshp_transport_mode) = 'SEA'
                            AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                            AND b.JMIL_HBL = a.JSHP_HOUSE_BILL_NO
                            AND a.JSHP_SHIPPED_ON_BOARD_DATE IS NULL
                            AND b.JMIL_NAME =
                                   'CONTACTED SHIPPER FOR CARGO READINESS'
                            AND a.JSHP_SHIPMENT_STATUS = 'Active'
                            AND c.MDPT_RID = JSHP_MDPT
                            AND MDPT_SEA = 'Y')
              WHERE outofsla = 0
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 4 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'Pending Cargo Pickup' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 4 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'Pending Cargo Pickup' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_A_RECEIVED_DATE)
                                      - TO_DATE (JSHP_E_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_E_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (JSHP_A_RECEIVED_DATE)
                              - TO_DATE (JSHP_E_RECEIVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE outofsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 5 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'Pending Cargo Receipt' Action,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_CARGO_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 5 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'Pending Cargo Receipt' Action,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (
                                           NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                                      - TO_DATE (JSHP_CARGO_RECEIVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND JSHP_CARGO_RECEIVED_DATE IS NULL
                     GROUP BY   TO_DATE (NVL (JSHP_A_RECEIVED_DATE, SYSDATE))
                              - TO_DATE (JSHP_CARGO_RECEIVED_DATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
              WHERE outofsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 6 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'Pending DG Application' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) <= 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) > 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NULL
                     GROUP BY JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE,
                                TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE))
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    WithinSLA,
                    outofsla
               FROM (  SELECT 6 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'Pending DG Application' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) <= 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_BOOKING_DATE) > 5
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NULL
                     GROUP BY JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE,
                                TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_BOOKING_DATE))
              WHERE outofsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 7 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'Pending DG Approved' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NOT NULL
                     GROUP BY JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE,
                                TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_APPROVED_DATE))
              WHERE withinsla = 1
             UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    JSHP_HOUSE_BILL_NO ref_no,
                    JSHP_A_BOOKING_DATE ref_date,
                    JSHP_MPRT_DESTINATION ref_type,
                    JSHP_FREIGHT_MODE ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 7 sno,
                              'Import Customer Service (LCL)' Dept,
                              'Sea Import' Product,
                              'Pending DG Approved' Action,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) <= 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (JCUS_DG_APPROVED_DATE) > 1
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA,
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE
                         FROM JSHP_SHIPMENT a, JCUS_CUSTOMS b
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                              AND a.JSHP_RID = b.JCUS_JSHP
                              AND JCUS_DG_BOOKING_DATE IS NOT NULL
                     GROUP BY JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE,
                                TO_DATE (JSHP_E_ARRIVAL_DATE)
                              - TO_DATE (JCUS_DG_APPROVED_DATE))
              WHERE outofsla = 1)
   GROUP BY ROWNUM,
            sno,
            Dept,
            Product,
            Action,
            Ref_No,
            Ref_Date,
            Ref_Type,
            Ref_Mode,
            withinsla,
            outofsla
   ORDER BY ROWNUM ASC

21. PROC_IMPORT_DOCUMENTATION

SELECT ROWNUM id,
          dept,
          product,
          action,
          COUNT,
          withinsla,
          outofsla
     FROM (SELECT dept,
                  product,
                  action,
                  CASE WHEN COUNT IS NULL THEN 0 ELSE COUNT END COUNT,
                  CASE WHEN withinsla IS NULL THEN 0 ELSE withinsla END
                     withinsla,
                  CASE WHEN outofsla IS NULL THEN 0 ELSE outofsla END
                     outofsla
             FROM (  SELECT sno,
                            dept,
                            product,
                            action,
                            SUM (withinsla + outofsla) COUNT,
                            CASE
                               WHEN sno IN ('1') THEN 0
                               ELSE SUM (withinsla)
                            END
                               withinsla,
                            CASE
                               WHEN sno IN ('1') THEN 0
                               ELSE SUM (outofsla)
                            END
                               outofsla
                       FROM (
                       SELECT 1 sno,
                                    'Import Documentation' Dept,
                                    'Sea Import' Product,
                                    'Master Job Listing' Action,
                                    count(jmst_rid)  WithinSLA,
                                    0 OutofSLA
                               FROM  jmst_master where jmst_consol_status = 'Active'
                                                                   AND UPPER (jmst_transport_mode) = 'SEA'
UNION
SELECT 2 sno,
                                    'Import Documentation' Dept,
                                    'Sea Import' Product,
                                    'Pending Cost update in Master (CFS/Transport)' Action,
                                    count(jmst_rid)  WithinSLA,
                                    0 OutofSLA
                               FROM          
                               jmst_master where
                               jmst_rid not in (select distinct jchg_jmst from jchg_charge,jmst_master where jchg_jmst is not null and jchg_jmst = jmst_rid) 
                               and pkg_mdpt.get_value(jmst_mcpy,jmst_mdpt,'IMPORT')='Y' and upper(jmst_consol_status) !='CANCELLED'
                                                                   AND UPPER (jmst_transport_mode) = 'SEA'
UNION
SELECT 3 sno,
                                    'Import Documentation' Dept,
                                    'Sea Import' Product,
                                    'Pending COST updation in HOUSE Level' Action,
                                    count(jshp_rid)  WithinSLA,
                                    0 OutofSLA
                               FROM          
                               JSHP_SHIPMENT where
                               jshp_rid not in (select distinct jchg_jshp from  jchg_charge,jmst_master
                            where jchg_jmst is not null
                            and   jchg_jmst = jmst_rid)
and pkg_mdpt.get_value(jshp_mcpy, jshp_mdpt, 'IMPORT')='Y'
                             AND  UPPER (jshp_transport_mode) = 'SEA'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
UNION
SELECT 4 sno,
                                    'Import Documentation' Dept,
                                    'Sea Import' Product,
                                    'Pending Import Manifest Filing' Action,
                                    count(JMST_CUSTOM_MRN_NO)  WithinSLA,
                                    0 OutofSLA
                               FROM          
                                    jmst_master where JMST_CUSTOM_MRN_NO is null and jmst_consol_mode = 'LCL'
                                    AND UPPER (jmst_transport_mode) = 'SEA'
UNION
SELECT 5 sno,
                                    'Import Documentation' Dept,
                                    'Sea Import' Product,
                                    'Pending CAN generation' Action,
                                    count(JSHP_RID)  WithinSLA,
                                    0 OutofSLA
                               FROM   
                               jshp_shipment where --jshp_can_date is null
                               UPPER (jshp_transport_mode) = 'SEA'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
UNION
SELECT 6 sno,
                                    'Import Documentation' Dept,
                                    'Sea Import' Product,
                                    'Pending Sales Invoice ( House Level )' Action,
                                    count(JSHP_RID)  WithinSLA,
                                    0 OutofSLA
                               FROM   
                               jshp_shipment where jshp_rid  not in (select distinct ajvd_jshp from ajvd_jvdetail, ajvh_jvheader
                            where ajvd_jshp is not null
                            and   ajvd_ajvh = ajvh_rid
                            and   ajvh_ajvt_type = 'INVOICE')
and pkg_mdpt.get_value(jshp_mcpy, jshp_mdpt, 'IMPORT')='Y'
AND UPPER (jshp_transport_mode) = 'SEA'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
UNION
SELECT 7 sno,
                                    'Import Documentation' Dept,
                                    'Sea Import' Product,
                                    'Pending DO' Action,
                                    count(JSHP_RID)  WithinSLA,
                                    0 OutofSLA
                               FROM
                                jshp_shipment where JSHP_DO_NO is null   
                                AND UPPER (jshp_transport_mode) = 'SEA'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                       )
                   GROUP BY sno,
                            dept,
                            product,
                            action
                   ORDER BY sno,
                            dept,
                            product,
                            action))


22. PROC_IMPORT_DOCUMENTATION_AIR

SELECT ROWNUM id,
          dept,
          product,
          action,
          COUNT,
          withinsla,
          outofsla
     FROM (SELECT dept,
                  product,
                  action,
                  CASE WHEN COUNT IS NULL THEN 0 ELSE COUNT END COUNT,
                  CASE WHEN withinsla IS NULL THEN 0 ELSE withinsla END
                     withinsla,
                  CASE WHEN outofsla IS NULL THEN 0 ELSE outofsla END
                     outofsla
             FROM (  SELECT sno,
                            dept,
                            product,
                            action,
                            SUM (withinsla + outofsla) COUNT,
                            CASE
                               WHEN sno IN ('1') THEN 0
                               ELSE SUM (withinsla)
                            END
                               withinsla,
                            CASE
                               WHEN sno IN ('1') THEN 0
                               ELSE SUM (outofsla)
                            END
                               outofsla
                       FROM (
                       SELECT 1 sno,
                                    'Import Documentation' Dept,
                                    'Air Import' Product,
                                    'Master Job Listing' Action,
                                    count(jmst_rid)  WithinSLA,
                                    0 OutofSLA
                               FROM  jmst_master where jmst_consol_status = 'Active'
                                                                   AND UPPER (jmst_transport_mode) = 'AIR'
UNION
SELECT 2 sno,
                                    'Import Documentation' Dept,
                                    'Air Import' Product,
                                    'Pending Cost update in Master (CFS/Transport)' Action,
                                    count(jmst_rid)  WithinSLA,
                                    0 OutofSLA
                               FROM          
                               jmst_master where
                               jmst_rid not in (select distinct jchg_jmst from jchg_charge,jmst_master where jchg_jmst is not null and jchg_jmst = jmst_rid) 
                               and pkg_mdpt.get_value(jmst_mcpy,jmst_mdpt,'IMPORT')='Y' and upper(jmst_consol_status) !='CANCELLED'
                                                                   AND UPPER (jmst_transport_mode) = 'AIR'
UNION
SELECT 3 sno,
                                    'Import Documentation' Dept,
                                    'Air Import' Product,
                                    'Pending COST updation in HOUSE Level' Action,
                                    count(jshp_rid)  WithinSLA,
                                    0 OutofSLA
                               FROM          
                               JSHP_SHIPMENT where
                               jshp_rid not in (select distinct jchg_jshp from  jchg_charge,jmst_master
                            where jchg_jmst is not null
                            and   jchg_jmst = jmst_rid)
and pkg_mdpt.get_value(jshp_mcpy, jshp_mdpt, 'IMPORT')='Y'
                             AND  UPPER (jshp_transport_mode) = 'AIR'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
UNION
SELECT 4 sno,
                                    'Import Documentation' Dept,
                                    'Air Import' Product,
                                    'Pending Import Manifest Filing' Action,
                                    count(JMST_CUSTOM_MRN_NO)  WithinSLA,
                                    0 OutofSLA
                               FROM          
                                    jmst_master where JMST_CUSTOM_MRN_NO is null and jmst_consol_mode = 'LCL'
                                    AND UPPER (jmst_transport_mode) = 'AIR'
UNION
SELECT 5 sno,
                                    'Import Documentation' Dept,
                                    'Air Import' Product,
                                    'Pending CAN generation' Action,
                                    count(JSHP_RID)  WithinSLA,
                                    0 OutofSLA
                               FROM   
                               jshp_shipment where --jshp_can_date is null
                               UPPER (jshp_transport_mode) = 'AIR'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
UNION
SELECT 6 sno,
                                    'Import Documentation' Dept,
                                    'Air Import' Product,
                                    'Pending Sales Invoice ( House Level )' Action,
                                    count(JSHP_RID)  WithinSLA,
                                    0 OutofSLA
                               FROM   
                               jshp_shipment where jshp_rid  not in (select distinct ajvd_jshp from ajvd_jvdetail, ajvh_jvheader
                            where ajvd_jshp is not null
                            and   ajvd_ajvh = ajvh_rid
                            and   ajvh_ajvt_type = 'INVOICE')
and pkg_mdpt.get_value(jshp_mcpy, jshp_mdpt, 'IMPORT')='Y'
AND UPPER (jshp_transport_mode) = 'AIR'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
UNION
SELECT 7 sno,
                                    'Import Documentation' Dept,
                                    'Air Import' Product,
                                    'Pending DO' Action,
                                    count(JSHP_RID)  WithinSLA,
                                    0 OutofSLA
                               FROM
                                jshp_shipment where JSHP_DO_NO is null   
                                AND UPPER (jshp_transport_mode) = 'AIR'
                                      AND UPPER (JSHP_SHIPMENT_TYPE) = 'IMPORT'
                       )
                   GROUP BY sno,
                            dept,
                            product,
                            action
                   ORDER BY sno,
                            dept,
                            product,
                            action))


23. PROC_IMPORT_SALES_SUPPORT

SELECT sno id,
          DEPT,
          PRODUCT,
          ACTION,
          COUNT,Within_Expiry_Date,Exceeded_Expiry_Date
     FROM (
              select sno,dept,product,action,(within_expiry_date+Exceeded_Expiry_Date) count,Within_Expiry_Date,Exceeded_Expiry_Date from(
     select sno,dept,product,action,sum(Within_Expiry_date) Within_Expiry_Date,sum(Exceeded_Expiry_Date) Exceeded_Expiry_Date from(     
     SELECT 1 sno,
                  'Sales Support' Dept,
                  'Sea Import' Product,
                  'Active Quotations' Action,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
             FROM RTEY_RATE_ENTRY
            WHERE RTEY_STATUS IN (NULL, 'Pending') group by to_date(RTEY_EXPIRY_DATE)-to_date(sysdate))group by sno,dept,product,action)
            UNION
           select sno,dept,product,action,(within_expiry_date+Exceeded_Expiry_Date) count,Within_Expiry_Date,Exceeded_Expiry_Date from(
     select sno,dept,product,action,sum(Within_Expiry_date) Within_Expiry_Date,sum(Exceeded_Expiry_Date) Exceeded_Expiry_Date from(     
     SELECT 2 sno,
                  'Sales Support' Dept,
                  'Sea Import' Product,
                  'Approved Quotations' Action,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
             FROM RTEY_RATE_ENTRY
            WHERE RTEY_STATUS IN ('Approved') group by RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate))group by sno,dept,product,action))

24. PROC_IMPORT_SALES_SUPPORT_AIR

SELECT sno id,
          DEPT,
          PRODUCT,
          ACTION,
          COUNT,Within_Expiry_Date,Exceeded_Expiry_Date
     FROM (
              select sno,dept,product,action,(within_expiry_date+Exceeded_Expiry_Date) count,Within_Expiry_Date,Exceeded_Expiry_Date from(
     select sno,dept,product,action,sum(Within_Expiry_date) Within_Expiry_Date,sum(Exceeded_Expiry_Date) Exceeded_Expiry_Date from(     
     SELECT 1 sno,
                  'Sales Support' Dept,
                  'Air Import' Product,
                  'Active Quotations' Action,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
             FROM RTEY_RATE_ENTRY
            WHERE RTEY_STATUS IN (NULL, 'Pending') group by to_date(RTEY_EXPIRY_DATE)-to_date(sysdate))group by sno,dept,product,action)
            UNION
           select sno,dept,product,action,(within_expiry_date+Exceeded_Expiry_Date) count,Within_Expiry_Date,Exceeded_Expiry_Date from(
     select sno,dept,product,action,sum(Within_Expiry_date) Within_Expiry_Date,sum(Exceeded_Expiry_Date) Exceeded_Expiry_Date from(     
     SELECT 2 sno,
                  'Sales Support' Dept,
                  'Air Import' Product,
                  'Approved Quotations' Action,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                  case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
             FROM RTEY_RATE_ENTRY
            WHERE RTEY_STATUS IN ('Approved') group by RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate))group by sno,dept,product,action))


25. PROC_IMPORT_SALES_SUPPORT_DETAILS

SELECT ROWNUM id,
          sno,
          dept,
          product,
          action,
          ref_no,
          ref_date,
          ref_type,
          ref_mode
     FROM (            
     select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(
          SELECT 1 sno,
                    'Sales Support' Dept,
                    'Sea Import' Product,
                    'Active Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS IN (NULL, 'Pending')
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)) where Within_Expiry_date>0
                    union
                      select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(
          SELECT 1 sno,
                    'Sales Support' Dept,
                    'Sea Import' Product,
                    'Active Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS IN (NULL, 'Pending')
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)) where Exceeded_Expiry_Date>0
                               UNION
                      select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(          
             SELECT 2 sno,
                    'Sales Support' Dept,
                    'Sea Import' Product,
                    'Approved Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                     case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate) 
                                        )  where Within_Expiry_date>0 
                                        union
           select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(          
             SELECT 2 sno,
                    'Sales Support' Dept,
                    'Sea Import' Product,
                    'Approved Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                     case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate) 
                                        )  where Exceeded_Expiry_Date>0 )


26. PROC_IMPORT_SALES_SUPPORT_DETAILS_AIR

SELECT ROWNUM id,
          sno,
          dept,
          product,
          action,
          ref_no,
          ref_date,
          ref_type,
          ref_mode
     FROM (            
     select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(
          SELECT 1 sno,
                    'Sales Support' Dept,
                    'Air Import' Product,
                    'Active Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS IN (NULL, 'Pending')
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)) where Within_Expiry_date>0
                    union
                      select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(
          SELECT 1 sno,
                    'Sales Support' Dept,
                    'Air Import' Product,
                    'Active Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS IN (NULL, 'Pending')
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)) where Exceeded_Expiry_Date>0
                               UNION
                      select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(          
             SELECT 2 sno,
                    'Sales Support' Dept,
                    'Air Import' Product,
                    'Approved Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                     case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate) 
                                        )  where Within_Expiry_date>0 
                                        union
           select sno,dept,product,action,ref_no,
          ref_date,
          ref_type,
          ref_mode from(          
             SELECT 2 sno,
                    'Sales Support' Dept,
                    'Air Import' Product,
                    'Approved Quotations' Action,
                    RTEY_RATE_NO Ref_No,
                    RTEY_RATE_DATE Ref_Date,
                    RTEY_TYPE Ref_Type,
                    RTEY_RATE_TYPE Ref_Mode,
                     case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)>=0 then 1 else 0 end Within_Expiry_date,
                    case when to_date(RTEY_EXPIRY_DATE)-to_date(sysdate)<0 then 1 else 0 end Exceeded_Expiry_Date
               FROM RTEY_RATE_ENTRY
              WHERE RTEY_STATUS = 'Approved'
           GROUP BY RTEY_RATE_NO,
                    RTEY_RATE_DATE,
                    RTEY_TYPE,
                    RTEY_RATE_TYPE,to_date(RTEY_EXPIRY_DATE)-to_date(sysdate) 
                                        )  where Exceeded_Expiry_Date>0 )


27. PROC_IMPORT_TRANSHIPMENT_DESK_AIR

SELECT sno id,
            dept,
            product,
            action,
            (SUM (withinsla) + SUM (outofsla)) COUNT,
            SUM (withinsla) withinsla,
            SUM (outofsla) outofsla
       FROM (  SELECT sno,
                      dept,
                      product,
                      action,
                      COUNT (withinsla) withinsla,
                      SUM (outofsla) outofsla
                 FROM (  SELECT sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                           FROM (  SELECT 1 sno,
                                          'Transhipment Desk' Dept,
                                          'Air Import' Product,
                                          'Pending for Export Vsl assigning' Action,
                                          JSHP_HOUSE_BILL_NO ref_no,
                                          JSHP_A_BOOKING_DATE ref_date,
                                          JSHP_MPRT_DESTINATION ref_type,
                                          JSHP_FREIGHT_MODE ref_mode,
                                          CASE
                                             WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                                  - TO_DATE (SYSDATE) >= 3
                                             THEN
                                                COUNT (*)
                                             ELSE
                                                0
                                          END
                                             WithinSLA,
                                          CASE
                                             WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                                  - TO_DATE (SYSDATE) < 3
                                             THEN
                                                COUNT (*)
                                             ELSE
                                                0
                                          END
                                             OutofSLA
                                     FROM JSHP_SHIPMENT
                                    WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                          AND JSHP_HOUSE_BILL_NO IS NOT NULL
                                          AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                                 GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                          - TO_DATE (SYSDATE),
                                          JSHP_HOUSE_BILL_NO,
                                          JSHP_A_BOOKING_DATE,
                                          JSHP_MPRT_DESTINATION,
                                          JSHP_FREIGHT_MODE)
                       GROUP BY sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                         HAVING withinsla > 0)
             GROUP BY sno,
                      dept,
                      product,
                      action
             UNION
               SELECT sno,
                      dept,
                      product,
                      action,
                      SUM (withinsla) withinsla,
                      COUNT (action) outofsla
                 FROM (  SELECT sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                           FROM (  SELECT 1 sno,
                                          'Transhipment Desk' Dept,
                                          'Air Import' Product,
                                          'Pending for Export Vsl assigning' Action,
                                          JSHP_HOUSE_BILL_NO ref_no,
                                          JSHP_A_BOOKING_DATE ref_date,
                                          JSHP_MPRT_DESTINATION ref_type,
                                          JSHP_FREIGHT_MODE ref_mode,
                                          CASE
                                             WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                                  - TO_DATE (SYSDATE) >= 3
                                             THEN
                                                COUNT (*)
                                             ELSE
                                                0
                                          END
                                             WithinSLA,
                                          CASE
                                             WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                                  - TO_DATE (SYSDATE) < 3
                                             THEN
                                                COUNT (*)
                                             ELSE
                                                0
                                          END
                                             OutofSLA
                                     FROM JSHP_SHIPMENT
                                    WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                          AND JSHP_HOUSE_BILL_NO IS NOT NULL
                                          AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                                 GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                          - TO_DATE (SYSDATE),
                                          JSHP_HOUSE_BILL_NO,
                                          JSHP_A_BOOKING_DATE,
                                          JSHP_MPRT_DESTINATION,
                                          JSHP_FREIGHT_MODE)
                       GROUP BY sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                         HAVING outofsla > 0)
             GROUP BY sno,
                      dept,
                      product,
                      action)
   GROUP BY sno,
            dept,
            product,
            action
   UNION
     SELECT sno,
            dept,
            product,
            action,
            (SUM (withinsla) + SUM (outofsla)) COUNT,
            SUM (withinsla) withinsla,
            SUM (outofsla) outofsla
       FROM (  SELECT sno,
                      dept,
                      product,
                      action,
                      COUNT (withinsla) withinsla,
                      SUM (outofsla) outofsla
                 FROM (  SELECT sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                           FROM (  SELECT 2 sno,
                                          'Transhipment Desk' Dept,
                                          'Air Import' Product,
                                          'Pending Export Consol Mapping' Action,
                                          JSHP_HOUSE_BILL_NO ref_no,
                                          JSHP_A_BOOKING_DATE ref_date,
                                          JSHP_MPRT_DESTINATION ref_type,
                                          JSHP_FREIGHT_MODE ref_mode,
                                          0 WithinSLA,
                                          0 OutofSLA
                                     FROM JSHP_SHIPMENT
                                    WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                          AND JSHP_HOUSE_BILL_NO IS NOT NULL
                                          AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                                 GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                          - TO_DATE (SYSDATE),
                                          JSHP_HOUSE_BILL_NO,
                                          JSHP_A_BOOKING_DATE,
                                          JSHP_MPRT_DESTINATION,
                                          JSHP_FREIGHT_MODE)
                       GROUP BY sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                         HAVING withinsla > 0)
             GROUP BY sno,
                      dept,
                      product,
                      action
             UNION
               SELECT sno,
                      dept,
                      product,
                      action,
                      SUM (withinsla) withinsla,
                      COUNT (action) outofsla
                 FROM (  SELECT sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                           FROM (  SELECT 2 sno,
                                          'Transhipment Desk' Dept,
                                          'Air Import' Product,
                                          'Pending Export Consol Mapping' Action,
                                          JSHP_HOUSE_BILL_NO ref_no,
                                          JSHP_A_BOOKING_DATE ref_date,
                                          JSHP_MPRT_DESTINATION ref_type,
                                          JSHP_FREIGHT_MODE ref_mode,
                                          0 WithinSLA,
                                          0 OutofSLA
                                     FROM JSHP_SHIPMENT
                                    WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                          AND JSHP_HOUSE_BILL_NO IS NOT NULL
                                          AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                                 GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                          - TO_DATE (SYSDATE),
                                          JSHP_HOUSE_BILL_NO,
                                          JSHP_A_BOOKING_DATE,
                                          JSHP_MPRT_DESTINATION,
                                          JSHP_FREIGHT_MODE)
                       GROUP BY sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                         HAVING outofsla > 0)
             GROUP BY sno,
                      dept,
                      product,
                      action)
   GROUP BY sno,
            dept,
            product,
            action
   UNION
     SELECT sno,
            dept,
            product,
            action,
            (SUM (withinsla) + SUM (outofsla)) COUNT,
            SUM (withinsla) withinsla,
            SUM (outofsla) outofsla
       FROM (  SELECT sno,
                      dept,
                      product,
                      action,
                      COUNT (withinsla) withinsla,
                      SUM (outofsla) outofsla
                 FROM (  SELECT sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                           FROM (  SELECT 3 sno,
                                          'Transhipment Desk' Dept,
                                          'Air Import' Product,
                                          'Pending LOA release for Transhipment Shipments'
                                             Action,
                                          JSHP_HOUSE_BILL_NO ref_no,
                                          JSHP_A_BOOKING_DATE ref_date,
                                          JSHP_MPRT_DESTINATION ref_type,
                                          JSHP_FREIGHT_MODE ref_mode,
                                          CASE
                                             WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                                  - TO_DATE (SYSDATE) <= 3
                                             THEN
                                                COUNT (*)
                                             ELSE
                                                0
                                          END
                                             WithinSLA,
                                          CASE
                                             WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                                  - TO_DATE (SYSDATE) > 3
                                             THEN
                                                COUNT (*)
                                             ELSE
                                                0
                                          END
                                             OutofSLA
                                     FROM JSHP_SHIPMENT
                                    WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                          AND JSHP_HOUSE_BILL_NO IS NOT NULL
                                          AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                                 GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                          - TO_DATE (SYSDATE),
                                          JSHP_HOUSE_BILL_NO,
                                          JSHP_A_BOOKING_DATE,
                                          JSHP_MPRT_DESTINATION,
                                          JSHP_FREIGHT_MODE)
                       GROUP BY sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                         HAVING withinsla > 0)
             GROUP BY sno,
                      dept,
                      product,
                      action
             UNION
               SELECT sno,
                      dept,
                      product,
                      action,
                      SUM (withinsla) withinsla,
                      COUNT (action) outofsla
                 FROM (  SELECT sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                           FROM (  SELECT 3 sno,
                                          'Transhipment Desk' Dept,
                                          'Air Import' Product,
                                          'Pending LOA release for Transhipment Shipments'
                                             Action,
                                          JSHP_HOUSE_BILL_NO ref_no,
                                          JSHP_A_BOOKING_DATE ref_date,
                                          JSHP_MPRT_DESTINATION ref_type,
                                          JSHP_FREIGHT_MODE ref_mode,
                                          CASE
                                             WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                                  - TO_DATE (SYSDATE) <= 3
                                             THEN
                                                COUNT (*)
                                             ELSE
                                                0
                                          END
                                             WithinSLA,
                                          CASE
                                             WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                                  - TO_DATE (SYSDATE) > 3
                                             THEN
                                                COUNT (*)
                                             ELSE
                                                0
                                          END
                                             OutofSLA
                                     FROM JSHP_SHIPMENT
                                    WHERE     UPPER (jshp_transport_mode) = 'AIR'
                                          AND JSHP_HOUSE_BILL_NO IS NOT NULL
                                          AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                                 GROUP BY   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                          - TO_DATE (SYSDATE),
                                          JSHP_HOUSE_BILL_NO,
                                          JSHP_A_BOOKING_DATE,
                                          JSHP_MPRT_DESTINATION,
                                          JSHP_FREIGHT_MODE)
                       GROUP BY sno,
                                dept,
                                product,
                                action,
                                ref_no,
                                ref_date,
                                ref_type,
                                ref_mode,
                                withinsla,
                                outofsla
                         HAVING outofsla > 0)
             GROUP BY sno,
                      dept,
                      product,
                      action)
   GROUP BY sno,
            dept,
            product,
            action


28.
PROC_IMPORT_TRANSHIPMENT_DESK_DETAILS_AIR

SELECT ROWNUM id,
          sno,
          dept,
          product,
          action,
          ref_no,
          ref_date,
          ref_type,
          ref_mode,
          withinsla,
          outofsla
     FROM (  SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 1 sno,
                              'Transhipment Desk' Dept,
                              'Air Import' Product,
                              'Pending for Export Vsl assigning' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) >= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) < 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING withinsla > 0
           UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 1 sno,
                              'Transhipment Desk' Dept,
                              'Air Import' Product,
                              'Pending for Export Vsl assigning' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) >= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) < 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING outofsla > 0
           UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 2 sno,
                              'Transhipment Desk' Dept,
                              'Air Import' Product,
                              'Pending Export Consol Mapping' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              0 WithinSLA,
                              0 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING withinsla > 0
           UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 2 sno,
                              'Transhipment Desk' Dept,
                              'Air Import' Product,
                              'Pending Export Consol Mapping' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              0 WithinSLA,
                              0 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING outofsla > 0
           UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 3 sno,
                              'Transhipment Desk' Dept,
                              'Air Import' Product,
                              'Pending LOA release for Transhipment Shipments'
                                 Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) <= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) > 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING withinsla > 0
           UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 3 sno,
                              'Transhipment Desk' Dept,
                              'Air Import' Product,
                              'Pending LOA release for Transhipment Shipments'
                                 Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) <= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) > 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'AIR'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING outofsla > 0)


29. PROC_IMPORT_TRANSHIPMENT_DESK_DETAILS_SEA

SELECT ROWNUM id,
          sno,
          dept,
          product,
          action,
          ref_no,
          ref_date,
          ref_type,
          ref_mode,
          withinsla,
          outofsla
     FROM (  SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 1 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending for Export Vsl assigning' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) >= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) < 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING withinsla > 0
           UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 1 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending for Export Vsl assigning' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) >= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) < 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING outofsla > 0
           UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 2 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending Export Consol Mapping' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              0 WithinSLA,
                              0 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING withinsla > 0
           UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 2 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending Export Consol Mapping' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              0 WithinSLA,
                              0 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING outofsla > 0
             union
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 3 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending LOA release for Transhipment Shipments'
                                 Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) <= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) > 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING withinsla > 0
           UNION
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 3 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending LOA release for Transhipment Shipments'
                                 Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) <= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) > 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING outofsla > 0)


30. PROC_IMPORT_TRANSHIPMENT_DESK_SEA

select sno id,dept,product,action,(sum(withinsla)+sum(outofsla))count,sum(withinsla) withinsla,sum(outofsla)outofsla from(
 select sno,dept,product,action,count(withinsla)withinsla,sum(outofsla)outofsla from(
SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM ( SELECT 1 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending for Export Vsl assigning' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) >= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) < 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING withinsla > 0)group by sno,dept,product,action
           UNION
           select sno,dept,product,action,sum(withinsla)withinsla,count(action)outofsla from(   
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 1 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending for Export Vsl assigning' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) >= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) < 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING outofsla > 0             
             )group by sno,dept,product,action  
             )group by sno,dept,product,action
             union
             select sno,dept,product,action,(sum(withinsla)+sum(outofsla))count,sum(withinsla) withinsla,sum(outofsla)outofsla from(
 select sno,dept,product,action,count(withinsla)withinsla,sum(outofsla)outofsla from(
SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM ( SELECT 2 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending Export Consol Mapping' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              0 WithinSLA,
                              0 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING withinsla > 0)group by sno,dept,product,action
           UNION
           select sno,dept,product,action,sum(withinsla)withinsla,count(action)outofsla from(   
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 2 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending Export Consol Mapping' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                               0 WithinSLA,
                              0 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING outofsla > 0             
             )group by sno,dept,product,action  
             )group by sno,dept,product,action
             union
             select sno,dept,product,action,(sum(withinsla)+sum(outofsla))count,sum(withinsla) withinsla,sum(outofsla)outofsla from(
 select sno,dept,product,action,count(withinsla)withinsla,sum(outofsla)outofsla from(
SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM ( SELECT 3 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending LOA release for Transhipment Shipments' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) <=3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) > 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING withinsla > 0)group by sno,dept,product,action
           UNION
           select sno,dept,product,action,sum(withinsla)withinsla,count(action)outofsla from(   
             SELECT sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
               FROM (  SELECT 3 sno,
                              'Transhipment Desk' Dept,
                              'Sea Import' Product,
                              'Pending LOA release for Transhipment Shipments' Action,
                              JSHP_HOUSE_BILL_NO ref_no,
                              JSHP_A_BOOKING_DATE ref_date,
                              JSHP_MPRT_DESTINATION ref_type,
                              JSHP_FREIGHT_MODE ref_mode,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) <= 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 WithinSLA,
                              CASE
                                 WHEN   TO_DATE (JSHP_E_ARRIVAL_DATE)
                                      - TO_DATE (SYSDATE) > 3
                                 THEN
                                    COUNT (*)
                                 ELSE
                                    0
                              END
                                 OutofSLA
                         FROM JSHP_SHIPMENT
                        WHERE     UPPER (jshp_transport_mode) = 'SEA'
                              AND JSHP_HOUSE_BILL_NO IS NOT NULL
                              AND JSHP_SHIPMENT_TYPE = 'Transhipment'
                     GROUP BY TO_DATE (JSHP_E_ARRIVAL_DATE) - TO_DATE (SYSDATE),
                              JSHP_HOUSE_BILL_NO,
                              JSHP_A_BOOKING_DATE,
                              JSHP_MPRT_DESTINATION,
                              JSHP_FREIGHT_MODE)
           GROUP BY sno,
                    dept,
                    product,
                    action,
                    ref_no,
                    ref_date,
                    ref_type,
                    ref_mode,
                    withinsla,
                    outofsla
             HAVING outofsla > 0             
             )group by sno,dept,product,action  
             )group by sno,dept,product,action


31. 
